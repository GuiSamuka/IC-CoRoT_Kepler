

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Tests &mdash; Filtering Techniques</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Reading the data" href="08%20-%20Phase%20Folded.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Filtering Techniques of Light Curves Obtained from CoRoT and Kepler satellites
          

          
            
            <img src="_static/Logos_white_bg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manipulating fits files</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html">Read <em>.fits</em> data</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Knowing-and-fixing-the-header">Knowing and fixing the header</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Algorithms">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Preprocessing-data">Preprocessing data</a></li>
</ul>
<p class="caption"><span class="caption-text">Filter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="02%20-%20Filters.html">Frequency Domain Filtering Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="02%20-%20Filters.html#Nonlinear-filter">Nonlinear filter</a></li>
</ul>
<p class="caption"><span class="caption-text">Ideal Lowpass Filter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Ideal%20Lowpass%20Filter.html">Reading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Ideal%20Lowpass%20Filter.html#Ideal-Lowpass-Filters">Ideal Lowpass Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Ideal%20Lowpass%20Filter.html#Choosing-the-best-Ideal-Filter-parameters">Choosing the best Ideal Filter parameters</a></li>
</ul>
<p class="caption"><span class="caption-text">Butterworth Filter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Butterworth%20Lowpass%20Filter.html">Reading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Butterworth%20Lowpass%20Filter.html#Butterworth-Transfer-Function">Butterworth Transfer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Butterworth%20Lowpass%20Filter.html#Choosing-the-best-Butterworth-parameters">Choosing the best Butterworth parameters</a></li>
</ul>
<p class="caption"><span class="caption-text">Gaussian Filter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Gaussian%20Lowpass%20Filter.html">Reading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Gaussian%20Lowpass%20Filter.html#Gaussian-Transfer-Function">Gaussian Transfer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Gaussian%20Lowpass%20Filter.html#Choosing-the-best-Gaussian-parameters">Choosing the best Gaussian parameters</a></li>
</ul>
<p class="caption"><span class="caption-text">Median Filter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="07%20-%20Median%20Filter.html">Reading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="07%20-%20Median%20Filter.html#Median-Filter">Median Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="07%20-%20Median%20Filter.html#Choosing-the-best-Median-parameter">Choosing the best Median parameter</a></li>
</ul>
<p class="caption"><span class="caption-text">Phase Folded</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="08%20-%20Phase%20Folded.html">Reading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="08%20-%20Phase%20Folded.html#Another-approach">Another approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="08%20-%20Phase%20Folded.html#ORMaster">ORMaster</a></li>
<li class="toctree-l1"><a class="reference internal" href="08%20-%20Phase%20Folded.html#Phase-Folded">Phase Folded</a></li>
</ul>
<p class="caption"><span class="caption-text">Machine Learning</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="#SkTime">SkTime</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Preprocessing-data">Preprocessing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Creating-matrix-of-features-(CoRoT-targets-with-confirmed-exoplanets)">Creating matrix of features (CoRoT targets with confirmed exoplanets)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Labeling-matrix-of-features">Labeling matrix of features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-dataset,-X-and-y">Creating dataset, X and y</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Machine-Learning---SkTime">Machine Learning - SkTime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Preliminaries"><strong>Preliminaries</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Splitting-the-dataset-into-the-Training-set-and-Test-set"><strong>Splitting the dataset into the Training set and Test set</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Time-Series-Classification"><strong>Time Series Classification</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Feature-extraction"><strong>Feature extraction</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Time-Series-Classification-with-Feature-Extraction"><strong>Time Series Classification with Feature Extraction</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#SkLearn">SkLearn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Preprocessing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Creating matrix of features (CoRoT targets with confirmed exoplanets)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Labeling matrix of features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Creating dataset, X and y</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Machine-Learning">Machine Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5"><strong>Preliminaries</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6"><strong>Splitting the dataset into the Training set and Test set</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7"><strong>Time Series Classification</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Filtering Techniques of Light Curves Obtained from CoRoT and Kepler satellites</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tests</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/09 - Machine Learning.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Tests">
<h1>Tests<a class="headerlink" href="#Tests" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="o">!</span>pip install control
<span class="kn">from</span> <span class="nn">tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Requirement already satisfied: control in /usr/local/lib/python3.7/dist-packages (0.9.0)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from control) (3.4.2)
Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from control) (1.7.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from control) (1.19.5)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;control) (1.3.1)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;control) (2.4.7)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;control) (7.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;control) (2.8.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;control) (0.10.0)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from cycler&gt;=0.10-&gt;matplotlib-&gt;control) (1.15.0)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># FILE_PATH = r&#39;C:\Users\guisa\Google Drive\01 - Iniciação Científica\02 - Datasets\csv_files\EN2_STAR_CHR_0101086161_20070516T060226_20071005T074409.csv&#39;</span>
<span class="n">FILE_PATH</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/csv_files/EN2_STAR_CHR_0101086161_20070516T060226_20071005T074409.csv&#39;</span>
</pre></div>
</div>
</div>
<p>Reading one time series</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">FILE_PATH</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE</th>
      <th>WHITEFLUX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2007-05-16 18:10:55.071642</td>
      <td>112626.77</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2007-05-16 18:19:27.113766</td>
      <td>112605.61</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2007-05-16 18:27:59.155929</td>
      <td>112771.50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2007-05-16 18:36:31.198092</td>
      <td>113113.60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2007-05-16 18:45:03.240256</td>
      <td>112621.79</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Taking only the flux and “saving” it as <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flux</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WHITEFLUX</span>
<span class="n">flux</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0        32847.277
1        32849.570
2        32850.133
3        32881.668
4        32897.824
           ...
24451    33611.984
24452    33498.582
24453    33537.754
24454    33552.040
24455    33650.860
Name: WHITEFLUX, Length: 24456, dtype: float64
</pre></div></div>
</div>
<p>Creating a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> and appending the data from <code class="docutils literal notranslate"><span class="pre">flux</span></code> to the first column and the first row.</p>
<p>Later, we are going to do the same for lightcurves</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># to SkTime</span>
<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">DF</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="n">flux</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">DF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time_series&#39;</span><span class="p">]</span>

<span class="n">DF</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1">###############################################################################</span>

<span class="c1"># to SKLEARN</span>
<span class="c1"># DF = pd.DataFrame()</span>

<span class="c1"># DF = DF.append(flux, ignore_index=True)</span>

<span class="c1"># DF.head()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time_series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0        32847.277
1        32849.570
2       ...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">DF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0        32847.277
1        32849.570
2        32850.133
3        32881.668
4        32897.824
           ...
24451    33611.984
24452    33498.582
24453    33537.754
24454    33552.040
24455    33650.860
Name: WHITEFLUX, Length: 24456, dtype: float64
</pre></div></div>
</div>
</div>
<div class="section" id="SkTime">
<h1>SkTime<a class="headerlink" href="#SkTime" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="o">!</span>pip install control
<span class="kn">from</span> <span class="nn">tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="Preprocessing-data">
<h2>Preprocessing data<a class="headerlink" href="#Preprocessing-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Creating-matrix-of-features-(CoRoT-targets-with-confirmed-exoplanets)">
<h3>Creating matrix of features (CoRoT targets with confirmed exoplanets)<a class="headerlink" href="#Creating-matrix-of-features-(CoRoT-targets-with-confirmed-exoplanets)" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># DATA_DIR = &#39;C:/Users/guisa/Google Drive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="c1"># DATA_DIR = &#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/resampled_files&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">root_dir_path</span><span class="p">,</span> <span class="n">sub_dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;desktop.ini&#39;</span> <span class="ow">and</span> <span class="s1">&#39;csv_files.rar&#39;</span><span class="p">):</span>
            <span class="c1"># File path</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">root_dir_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="c1"># Reading data</span>
            <span class="c1"># print(path)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">flux</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WHITEFLUX</span>

            <span class="c1"># Add timeseries to pd.DataFrame</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="n">flux</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time_series&#39;</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time_series</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0        141157.216020
1        141242.434636
...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0        26051.806326
1        26113.304520
2 ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0        1.298393e+06
1        1.299550e+06
2 ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0        112521.329834
1        112758.045853
...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0        40643.684746
1        40245.967717
2 ...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0        141157.216020
1        141242.434636
2        141132.564812
3        141373.143346
4        141213.262888
             ...
15045    141147.423729
15046    141100.943892
15047    141378.202818
15048    141228.656766
15049    141309.960163
Name: WHITEFLUX, Length: 15050, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(33, 1)
</pre></div></div>
</div>
</div>
<div class="section" id="Labeling-matrix-of-features">
<h3>Labeling matrix of features<a class="headerlink" href="#Labeling-matrix-of-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>0: confirmed_exoplanets</p></li>
<li><p>1: eclipsing_binaries</p></li>
<li><p>2: none</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    0
1    0
2    0
3    0
4    0
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(33,)
</pre></div></div>
</div>
</div>
<div class="section" id="Creating-dataset,-X-and-y">
<h3>Creating dataset, X and y<a class="headerlink" href="#Creating-dataset,-X-and-y" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Creating pd.DataFrame with X data, and setted columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time_series&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">])</span>

<span class="c1"># Adding labels</span>
<span class="n">df</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">y</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time_series</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0        141157.216020
1        141242.434636
...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0        26051.806326
1        26113.304520
2 ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0        1.298393e+06
1        1.299550e+06
2 ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0        112521.329834
1        112758.045853
...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0        40643.684746
1        40245.967717
2 ...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>How many Labels we got ?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Labels =&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Counts =&#39;</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Labels = [0]
Counts = [33]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Machine-Learning---SkTime">
<h2>Machine Learning - SkTime<a class="headerlink" href="#Machine-Learning---SkTime" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/alan-turing-institute/sktime/tree/v0.4.3">https://github.com/alan-turing-institute/sktime/tree/v0.4.3</a></p>
<p><a class="reference external" href="https://github.com/alan-turing-institute/sktime/blob/main/sktime/classification/compose/">https://github.com/alan-turing-institute/sktime/blob/main/sktime/classification/compose/</a><strong>init</strong>.py</p>
<div class="section" id="Preliminaries">
<h3><strong>Preliminaries</strong><a class="headerlink" href="#Preliminaries" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># !pip install sktime[all_extras]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Splitting-the-dataset-into-the-Training-set-and-Test-set">
<h3><strong>Splitting the dataset into the Training set and Test set</strong><a class="headerlink" href="#Splitting-the-dataset-into-the-Training-set-and-Test-set" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(24, 1) (24,) (9, 1) (9,)
</pre></div></div>
</div>
</div>
<div class="section" id="Time-Series-Classification">
<h3><strong>Time Series Classification</strong><a class="headerlink" href="#Time-Series-Classification" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://towardsdatascience.com/sktime-a-unified-python-library-for-time-series-machine-learning-3c103c139a55">https://towardsdatascience.com/sktime-a-unified-python-library-for-time-series-machine-learning-3c103c139a55</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.classification.all</span> <span class="kn">import</span> <span class="n">TimeSeriesForestClassifier</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">TimeSeriesForestClassifier</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TimeSeriesForestClassifier()
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Feature-extraction">
<h3><strong>Feature extraction</strong><a class="headerlink" href="#Feature-extraction" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;statsmodels.tsa.ar_model.AR&#39;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.transformations.panel.tsfresh</span> <span class="kn">import</span> <span class="n">TSFreshFeatureExtractor</span>

<span class="n">transformer</span> <span class="o">=</span> <span class="n">TSFreshFeatureExtractor</span><span class="p">(</span><span class="n">default_fc_parameters</span><span class="o">=</span><span class="s2">&quot;minimal&quot;</span><span class="p">)</span>

<span class="n">extracted_features</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">extracted_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

Feature Extraction:   0%|          | 0/5 [00:00&lt;?, ?it/s]
Feature Extraction:  20%|██        | 1/5 [00:00&lt;00:00,  7.32it/s]
Feature Extraction: 100%|██████████| 5/5 [00:00&lt;00:00, 18.29it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time_series__sum_values</th>
      <th>time_series__median</th>
      <th>time_series__mean</th>
      <th>time_series__length</th>
      <th>time_series__standard_deviation</th>
      <th>time_series__variance</th>
      <th>time_series__root_mean_square</th>
      <th>time_series__maximum</th>
      <th>time_series__minimum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.124862e+09</td>
      <td>141218.330072</td>
      <td>141186.836848</td>
      <td>15050.0</td>
      <td>282.683706</td>
      <td>79910.077814</td>
      <td>141187.119841</td>
      <td>142021.360654</td>
      <td>138999.945791</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.136100e+08</td>
      <td>40704.273331</td>
      <td>40771.427763</td>
      <td>15050.0</td>
      <td>560.265206</td>
      <td>313897.101078</td>
      <td>40775.277055</td>
      <td>44921.695568</td>
      <td>39239.685767</td>
    </tr>
    <tr>
      <th>16</th>
      <td>6.258849e+08</td>
      <td>41653.547836</td>
      <td>41587.034197</td>
      <td>15050.0</td>
      <td>364.389989</td>
      <td>132780.064141</td>
      <td>41588.630578</td>
      <td>42472.076073</td>
      <td>40477.653465</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.512183e+09</td>
      <td>299686.539820</td>
      <td>299812.826420</td>
      <td>15050.0</td>
      <td>613.298072</td>
      <td>376134.525086</td>
      <td>299813.453701</td>
      <td>302311.608084</td>
      <td>297465.565232</td>
    </tr>
    <tr>
      <th>13</th>
      <td>5.857504e+08</td>
      <td>38822.561668</td>
      <td>38920.292034</td>
      <td>15050.0</td>
      <td>553.820584</td>
      <td>306717.239608</td>
      <td>38924.232160</td>
      <td>40531.501716</td>
      <td>37855.665849</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># If the result is 1, it means that the entire dataset has de same lenght</span>

<span class="n">extracted_features</span><span class="o">.</span><span class="n">time_series__length</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1
</pre></div></div>
</div>
</div>
<div class="section" id="Time-Series-Classification-with-Feature-Extraction">
<h3><strong>Time Series Classification with Feature Extraction</strong><a class="headerlink" href="#Time-Series-Classification-with-Feature-Extraction" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">TSFreshFeatureExtractor</span><span class="p">(</span><span class="n">show_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

Feature Extraction:   0%|          | 0/5 [00:00&lt;?, ?it/s]
Feature Extraction:  20%|██        | 1/5 [01:28&lt;05:53, 88.44s/it]
Feature Extraction:  40%|████      | 2/5 [03:13&lt;04:40, 93.37s/it]
Feature Extraction:  60%|██████    | 3/5 [04:51&lt;03:09, 94.94s/it]
Feature Extraction:  80%|████████  | 4/5 [06:30&lt;01:36, 96.16s/it]
Feature Extraction: 100%|██████████| 5/5 [07:48&lt;00:00, 93.60s/it]

Feature Extraction:   0%|          | 0/5 [00:00&lt;?, ?it/s]
Feature Extraction:  20%|██        | 1/5 [00:45&lt;03:02, 45.55s/it]
Feature Extraction:  40%|████      | 2/5 [01:17&lt;02:03, 41.33s/it]
Feature Extraction:  60%|██████    | 3/5 [01:52&lt;01:18, 39.44s/it]
Feature Extraction:  80%|████████  | 4/5 [02:32&lt;00:39, 39.77s/it]
Feature Extraction: 100%|██████████| 5/5 [02:50&lt;00:00, 34.17s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="SkLearn">
<h1>SkLearn<a class="headerlink" href="#SkLearn" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="o">!</span>pip install control
<span class="kn">from</span> <span class="nn">tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>Preprocessing data<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Creating matrix of features (CoRoT targets with confirmed exoplanets)<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># DATA_DIR = &#39;C:/Users/guisa/Google Drive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="c1"># DATA_DIR = &#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/resampled_files&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">root_dir_path</span><span class="p">,</span> <span class="n">sub_dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;desktop.ini&#39;</span> <span class="ow">and</span> <span class="s1">&#39;csv_files.rar&#39;</span><span class="p">):</span>
            <span class="c1"># File path</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">root_dir_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="c1"># Reading data</span>
            <span class="c1"># print(path)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">flux</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WHITEFLUX</span>

            <span class="c1"># Add timeseries to pd.DataFrame</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>15010</th>
      <th>15011</th>
      <th>15012</th>
      <th>15013</th>
      <th>15014</th>
      <th>15015</th>
      <th>15016</th>
      <th>15017</th>
      <th>15018</th>
      <th>15019</th>
      <th>15020</th>
      <th>15021</th>
      <th>15022</th>
      <th>15023</th>
      <th>15024</th>
      <th>15025</th>
      <th>15026</th>
      <th>15027</th>
      <th>15028</th>
      <th>15029</th>
      <th>15030</th>
      <th>15031</th>
      <th>15032</th>
      <th>15033</th>
      <th>15034</th>
      <th>15035</th>
      <th>15036</th>
      <th>15037</th>
      <th>15038</th>
      <th>15039</th>
      <th>15040</th>
      <th>15041</th>
      <th>15042</th>
      <th>15043</th>
      <th>15044</th>
      <th>15045</th>
      <th>15046</th>
      <th>15047</th>
      <th>15048</th>
      <th>15049</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.411572e+05</td>
      <td>1.412424e+05</td>
      <td>1.411326e+05</td>
      <td>1.413731e+05</td>
      <td>1.412133e+05</td>
      <td>1.413579e+05</td>
      <td>1.411959e+05</td>
      <td>1.412497e+05</td>
      <td>1.413829e+05</td>
      <td>1.414096e+05</td>
      <td>1.412703e+05</td>
      <td>1.412327e+05</td>
      <td>1.411492e+05</td>
      <td>1.412873e+05</td>
      <td>1.412144e+05</td>
      <td>1.411442e+05</td>
      <td>1.412001e+05</td>
      <td>1.412225e+05</td>
      <td>1.413235e+05</td>
      <td>1.412076e+05</td>
      <td>1.411856e+05</td>
      <td>1.411647e+05</td>
      <td>1.412128e+05</td>
      <td>1.413366e+05</td>
      <td>1.412635e+05</td>
      <td>1.413088e+05</td>
      <td>1.413307e+05</td>
      <td>1.411438e+05</td>
      <td>1.412988e+05</td>
      <td>1.411502e+05</td>
      <td>1.411364e+05</td>
      <td>1.414083e+05</td>
      <td>1.410876e+05</td>
      <td>1.411729e+05</td>
      <td>1.412924e+05</td>
      <td>1.413673e+05</td>
      <td>1.412330e+05</td>
      <td>1.411206e+05</td>
      <td>1.413310e+05</td>
      <td>1.411721e+05</td>
      <td>...</td>
      <td>1.411859e+05</td>
      <td>1.411025e+05</td>
      <td>1.410474e+05</td>
      <td>1.411354e+05</td>
      <td>1.411319e+05</td>
      <td>1.412317e+05</td>
      <td>1.411159e+05</td>
      <td>1.412205e+05</td>
      <td>1.411621e+05</td>
      <td>1.411025e+05</td>
      <td>1.412063e+05</td>
      <td>1.411235e+05</td>
      <td>1.411927e+05</td>
      <td>1.412480e+05</td>
      <td>1.412074e+05</td>
      <td>1.411396e+05</td>
      <td>1.411576e+05</td>
      <td>1.410457e+05</td>
      <td>1.411399e+05</td>
      <td>1.408885e+05</td>
      <td>1.409958e+05</td>
      <td>1.411260e+05</td>
      <td>1.411951e+05</td>
      <td>1.411575e+05</td>
      <td>1.411057e+05</td>
      <td>1.411124e+05</td>
      <td>1.412933e+05</td>
      <td>1.411076e+05</td>
      <td>1.410541e+05</td>
      <td>1.411741e+05</td>
      <td>1.409121e+05</td>
      <td>1.409989e+05</td>
      <td>1.412270e+05</td>
      <td>1.411838e+05</td>
      <td>1.413012e+05</td>
      <td>1.411474e+05</td>
      <td>1.411009e+05</td>
      <td>1.413782e+05</td>
      <td>1.412287e+05</td>
      <td>1.413100e+05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.605181e+04</td>
      <td>2.611330e+04</td>
      <td>2.601663e+04</td>
      <td>2.614152e+04</td>
      <td>2.587125e+04</td>
      <td>2.587146e+04</td>
      <td>2.602901e+04</td>
      <td>2.604010e+04</td>
      <td>2.611140e+04</td>
      <td>2.607349e+04</td>
      <td>2.612061e+04</td>
      <td>2.601961e+04</td>
      <td>2.608381e+04</td>
      <td>2.615512e+04</td>
      <td>2.605209e+04</td>
      <td>2.615393e+04</td>
      <td>2.595893e+04</td>
      <td>2.613356e+04</td>
      <td>2.608572e+04</td>
      <td>2.604287e+04</td>
      <td>2.609076e+04</td>
      <td>2.603981e+04</td>
      <td>2.604673e+04</td>
      <td>2.605018e+04</td>
      <td>2.605711e+04</td>
      <td>2.603637e+04</td>
      <td>2.602297e+04</td>
      <td>2.610288e+04</td>
      <td>2.599291e+04</td>
      <td>2.599706e+04</td>
      <td>2.596696e+04</td>
      <td>2.610334e+04</td>
      <td>2.616852e+04</td>
      <td>2.615221e+04</td>
      <td>2.600709e+04</td>
      <td>2.604340e+04</td>
      <td>2.602915e+04</td>
      <td>2.623798e+04</td>
      <td>2.596439e+04</td>
      <td>2.610146e+04</td>
      <td>...</td>
      <td>2.621469e+04</td>
      <td>2.632878e+04</td>
      <td>2.624308e+04</td>
      <td>2.622704e+04</td>
      <td>2.618278e+04</td>
      <td>2.624397e+04</td>
      <td>2.632099e+04</td>
      <td>2.627644e+04</td>
      <td>2.625360e+04</td>
      <td>2.632872e+04</td>
      <td>2.625611e+04</td>
      <td>2.633979e+04</td>
      <td>2.629440e+04</td>
      <td>2.627620e+04</td>
      <td>2.635345e+04</td>
      <td>2.628232e+04</td>
      <td>2.634446e+04</td>
      <td>2.636739e+04</td>
      <td>2.625771e+04</td>
      <td>2.648313e+04</td>
      <td>2.638753e+04</td>
      <td>2.626968e+04</td>
      <td>2.623826e+04</td>
      <td>2.630487e+04</td>
      <td>2.624348e+04</td>
      <td>2.638560e+04</td>
      <td>2.620561e+04</td>
      <td>2.630678e+04</td>
      <td>2.627786e+04</td>
      <td>2.616603e+04</td>
      <td>2.631367e+04</td>
      <td>2.620188e+04</td>
      <td>2.618542e+04</td>
      <td>2.624512e+04</td>
      <td>2.625785e+04</td>
      <td>2.642315e+04</td>
      <td>2.621238e+04</td>
      <td>2.636027e+04</td>
      <td>2.629231e+04</td>
      <td>2.618336e+04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.298393e+06</td>
      <td>1.299550e+06</td>
      <td>1.299725e+06</td>
      <td>1.299612e+06</td>
      <td>1.299747e+06</td>
      <td>1.299215e+06</td>
      <td>1.299576e+06</td>
      <td>1.299769e+06</td>
      <td>1.299262e+06</td>
      <td>1.299409e+06</td>
      <td>1.299280e+06</td>
      <td>1.299889e+06</td>
      <td>1.299150e+06</td>
      <td>1.299826e+06</td>
      <td>1.298902e+06</td>
      <td>1.299552e+06</td>
      <td>1.299346e+06</td>
      <td>1.298708e+06</td>
      <td>1.299628e+06</td>
      <td>1.299107e+06</td>
      <td>1.299239e+06</td>
      <td>1.299363e+06</td>
      <td>1.299605e+06</td>
      <td>1.299160e+06</td>
      <td>1.299955e+06</td>
      <td>1.299210e+06</td>
      <td>1.299477e+06</td>
      <td>1.299130e+06</td>
      <td>1.299318e+06</td>
      <td>1.298997e+06</td>
      <td>1.299127e+06</td>
      <td>1.299335e+06</td>
      <td>1.299339e+06</td>
      <td>1.299389e+06</td>
      <td>1.299585e+06</td>
      <td>1.299507e+06</td>
      <td>1.298837e+06</td>
      <td>1.299754e+06</td>
      <td>1.298997e+06</td>
      <td>1.300436e+06</td>
      <td>...</td>
      <td>1.295584e+06</td>
      <td>1.296259e+06</td>
      <td>1.295880e+06</td>
      <td>1.296397e+06</td>
      <td>1.295613e+06</td>
      <td>1.295237e+06</td>
      <td>1.295789e+06</td>
      <td>1.295417e+06</td>
      <td>1.295453e+06</td>
      <td>1.295508e+06</td>
      <td>1.295937e+06</td>
      <td>1.294957e+06</td>
      <td>1.295125e+06</td>
      <td>1.294599e+06</td>
      <td>1.294709e+06</td>
      <td>1.295073e+06</td>
      <td>1.295429e+06</td>
      <td>1.295154e+06</td>
      <td>1.295264e+06</td>
      <td>1.295769e+06</td>
      <td>1.295695e+06</td>
      <td>1.295337e+06</td>
      <td>1.295557e+06</td>
      <td>1.295314e+06</td>
      <td>1.295710e+06</td>
      <td>1.295153e+06</td>
      <td>1.295031e+06</td>
      <td>1.295029e+06</td>
      <td>1.295460e+06</td>
      <td>1.295186e+06</td>
      <td>1.294849e+06</td>
      <td>1.295283e+06</td>
      <td>1.294897e+06</td>
      <td>1.294750e+06</td>
      <td>1.294881e+06</td>
      <td>1.294939e+06</td>
      <td>1.295167e+06</td>
      <td>1.295158e+06</td>
      <td>1.295069e+06</td>
      <td>1.294454e+06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.125213e+05</td>
      <td>1.127580e+05</td>
      <td>1.129430e+05</td>
      <td>1.125623e+05</td>
      <td>1.127893e+05</td>
      <td>1.125752e+05</td>
      <td>1.127852e+05</td>
      <td>1.126351e+05</td>
      <td>1.126462e+05</td>
      <td>1.126747e+05</td>
      <td>1.128206e+05</td>
      <td>1.126230e+05</td>
      <td>1.127497e+05</td>
      <td>1.127325e+05</td>
      <td>1.127567e+05</td>
      <td>1.127885e+05</td>
      <td>1.126766e+05</td>
      <td>1.127609e+05</td>
      <td>1.125398e+05</td>
      <td>1.127966e+05</td>
      <td>1.126471e+05</td>
      <td>1.126480e+05</td>
      <td>1.128501e+05</td>
      <td>1.128040e+05</td>
      <td>1.127078e+05</td>
      <td>1.128669e+05</td>
      <td>1.126771e+05</td>
      <td>1.127147e+05</td>
      <td>1.127916e+05</td>
      <td>1.126816e+05</td>
      <td>1.127761e+05</td>
      <td>1.126781e+05</td>
      <td>1.127678e+05</td>
      <td>1.127868e+05</td>
      <td>1.125911e+05</td>
      <td>1.127481e+05</td>
      <td>1.127409e+05</td>
      <td>1.126717e+05</td>
      <td>1.126739e+05</td>
      <td>1.125557e+05</td>
      <td>...</td>
      <td>1.124980e+05</td>
      <td>1.125445e+05</td>
      <td>1.125411e+05</td>
      <td>1.125625e+05</td>
      <td>1.124583e+05</td>
      <td>1.125062e+05</td>
      <td>1.123094e+05</td>
      <td>1.126122e+05</td>
      <td>1.126024e+05</td>
      <td>1.123122e+05</td>
      <td>1.125150e+05</td>
      <td>1.124099e+05</td>
      <td>1.124539e+05</td>
      <td>1.123920e+05</td>
      <td>1.124828e+05</td>
      <td>1.124690e+05</td>
      <td>1.125900e+05</td>
      <td>1.125468e+05</td>
      <td>1.123983e+05</td>
      <td>1.125112e+05</td>
      <td>1.124692e+05</td>
      <td>1.124070e+05</td>
      <td>1.125379e+05</td>
      <td>1.124257e+05</td>
      <td>1.125522e+05</td>
      <td>1.124184e+05</td>
      <td>1.125103e+05</td>
      <td>1.123842e+05</td>
      <td>1.126233e+05</td>
      <td>1.123789e+05</td>
      <td>1.123924e+05</td>
      <td>1.123847e+05</td>
      <td>1.125097e+05</td>
      <td>1.125469e+05</td>
      <td>1.124996e+05</td>
      <td>1.125005e+05</td>
      <td>1.124207e+05</td>
      <td>1.124281e+05</td>
      <td>1.124471e+05</td>
      <td>1.123491e+05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.064368e+04</td>
      <td>4.024597e+04</td>
      <td>4.043663e+04</td>
      <td>4.031514e+04</td>
      <td>4.029457e+04</td>
      <td>4.023700e+04</td>
      <td>4.029928e+04</td>
      <td>4.044337e+04</td>
      <td>4.056287e+04</td>
      <td>4.024665e+04</td>
      <td>4.043309e+04</td>
      <td>4.036776e+04</td>
      <td>4.041253e+04</td>
      <td>4.034370e+04</td>
      <td>4.067833e+04</td>
      <td>4.021538e+04</td>
      <td>4.045781e+04</td>
      <td>4.032538e+04</td>
      <td>4.037169e+04</td>
      <td>4.034290e+04</td>
      <td>4.028767e+04</td>
      <td>4.024320e+04</td>
      <td>4.023320e+04</td>
      <td>4.024396e+04</td>
      <td>4.034883e+04</td>
      <td>4.034518e+04</td>
      <td>4.028057e+04</td>
      <td>4.029106e+04</td>
      <td>4.048474e+04</td>
      <td>4.029657e+04</td>
      <td>4.035592e+04</td>
      <td>4.021696e+04</td>
      <td>4.020960e+04</td>
      <td>4.021597e+04</td>
      <td>4.026372e+04</td>
      <td>4.027219e+04</td>
      <td>4.024717e+04</td>
      <td>4.023869e+04</td>
      <td>4.038073e+04</td>
      <td>4.031858e+04</td>
      <td>...</td>
      <td>4.300994e+04</td>
      <td>4.303990e+04</td>
      <td>4.306673e+04</td>
      <td>4.301858e+04</td>
      <td>4.267300e+04</td>
      <td>4.247712e+04</td>
      <td>4.262169e+04</td>
      <td>4.277094e+04</td>
      <td>4.303920e+04</td>
      <td>4.267297e+04</td>
      <td>4.267512e+04</td>
      <td>4.263271e+04</td>
      <td>4.274761e+04</td>
      <td>4.247607e+04</td>
      <td>4.258747e+04</td>
      <td>4.217027e+04</td>
      <td>4.206883e+04</td>
      <td>4.236280e+04</td>
      <td>4.214163e+04</td>
      <td>4.226997e+04</td>
      <td>4.200494e+04</td>
      <td>4.193790e+04</td>
      <td>4.209874e+04</td>
      <td>4.221375e+04</td>
      <td>4.254759e+04</td>
      <td>4.279462e+04</td>
      <td>4.288303e+04</td>
      <td>4.289924e+04</td>
      <td>4.287694e+04</td>
      <td>4.282583e+04</td>
      <td>4.266600e+04</td>
      <td>4.277455e+04</td>
      <td>4.272497e+04</td>
      <td>4.275998e+04</td>
      <td>4.296628e+04</td>
      <td>4.300132e+04</td>
      <td>4.278209e+04</td>
      <td>4.265919e+04</td>
      <td>4.269699e+04</td>
      <td>4.274217e+04</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 15050 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(33, 15050)
</pre></div></div>
</div>
</div>
<div class="section" id="id3">
<h3>Labeling matrix of features<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>0: confirmed_exoplanets</p></li>
<li><p>1: eclipsing_binaries</p></li>
<li><p>2: none</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0, 0, 0, ..., 0, 0, 0])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    0
1    0
2    0
3    0
4    0
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(496650,)
</pre></div></div>
</div>
</div>
<div class="section" id="id4">
<h3>Creating dataset, X and y<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Creating pd.DataFrame with X data, and setted columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Adding labels</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>15011</th>
      <th>15012</th>
      <th>15013</th>
      <th>15014</th>
      <th>15015</th>
      <th>15016</th>
      <th>15017</th>
      <th>15018</th>
      <th>15019</th>
      <th>15020</th>
      <th>15021</th>
      <th>15022</th>
      <th>15023</th>
      <th>15024</th>
      <th>15025</th>
      <th>15026</th>
      <th>15027</th>
      <th>15028</th>
      <th>15029</th>
      <th>15030</th>
      <th>15031</th>
      <th>15032</th>
      <th>15033</th>
      <th>15034</th>
      <th>15035</th>
      <th>15036</th>
      <th>15037</th>
      <th>15038</th>
      <th>15039</th>
      <th>15040</th>
      <th>15041</th>
      <th>15042</th>
      <th>15043</th>
      <th>15044</th>
      <th>15045</th>
      <th>15046</th>
      <th>15047</th>
      <th>15048</th>
      <th>15049</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>30819.826000</td>
      <td>30766.330239</td>
      <td>30751.556425</td>
      <td>30749.078411</td>
      <td>30735.472031</td>
      <td>30705.364719</td>
      <td>30673.455704</td>
      <td>30662.058557</td>
      <td>30682.811774</td>
      <td>30726.006400</td>
      <td>30766.044428</td>
      <td>30779.528462</td>
      <td>30762.480430</td>
      <td>30733.670298</td>
      <td>30721.967523</td>
      <td>30747.701120</td>
      <td>30810.995926</td>
      <td>30892.582773</td>
      <td>30963.134137</td>
      <td>30994.637790</td>
      <td>30971.285524</td>
      <td>30899.489245</td>
      <td>30812.158646</td>
      <td>30757.956592</td>
      <td>30773.076489</td>
      <td>30850.996851</td>
      <td>30937.516699</td>
      <td>30965.531315</td>
      <td>30909.779524</td>
      <td>30815.873666</td>
      <td>30770.754493</td>
      <td>30830.580119</td>
      <td>30965.570660</td>
      <td>31074.862790</td>
      <td>31066.062397</td>
      <td>30933.718685</td>
      <td>30766.639144</td>
      <td>30675.022829</td>
      <td>30700.963010</td>
      <td>30791.397016</td>
      <td>...</td>
      <td>31257.034885</td>
      <td>31264.336563</td>
      <td>31300.065245</td>
      <td>31342.684879</td>
      <td>31375.525377</td>
      <td>31386.046775</td>
      <td>31362.258516</td>
      <td>31301.359103</td>
      <td>31225.968013</td>
      <td>31185.069625</td>
      <td>31225.200043</td>
      <td>31348.360808</td>
      <td>31494.844160</td>
      <td>31574.995403</td>
      <td>31532.203536</td>
      <td>31387.986425</td>
      <td>31230.251847</td>
      <td>31151.297131</td>
      <td>31183.599756</td>
      <td>31282.844881</td>
      <td>31368.501950</td>
      <td>31386.865644</td>
      <td>31347.153080</td>
      <td>31306.651124</td>
      <td>31321.815477</td>
      <td>31405.234907</td>
      <td>31518.720306</td>
      <td>31602.739344</td>
      <td>31617.101315</td>
      <td>31564.063024</td>
      <td>31481.233700</td>
      <td>31413.127641</td>
      <td>31382.205800</td>
      <td>31377.323280</td>
      <td>31364.368751</td>
      <td>31310.075393</td>
      <td>31203.441067</td>
      <td>31062.404104</td>
      <td>30923.186993</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>141157.216020</td>
      <td>141242.434636</td>
      <td>141132.564812</td>
      <td>141373.143346</td>
      <td>141213.262888</td>
      <td>141357.927056</td>
      <td>141195.854576</td>
      <td>141249.723060</td>
      <td>141382.882136</td>
      <td>141409.646127</td>
      <td>141270.347310</td>
      <td>141232.742194</td>
      <td>141149.203020</td>
      <td>141287.347367</td>
      <td>141214.443625</td>
      <td>141144.196655</td>
      <td>141200.096238</td>
      <td>141222.533249</td>
      <td>141323.471805</td>
      <td>141207.648435</td>
      <td>141185.552578</td>
      <td>141164.668742</td>
      <td>141212.764561</td>
      <td>141336.627107</td>
      <td>141263.521595</td>
      <td>141308.810296</td>
      <td>141330.700205</td>
      <td>141143.809870</td>
      <td>141298.757841</td>
      <td>141150.205593</td>
      <td>141136.397407</td>
      <td>141408.260213</td>
      <td>141087.606264</td>
      <td>141172.925450</td>
      <td>141292.442324</td>
      <td>141367.329433</td>
      <td>141232.994283</td>
      <td>141120.579153</td>
      <td>141330.990802</td>
      <td>141172.077723</td>
      <td>...</td>
      <td>141102.476944</td>
      <td>141047.400969</td>
      <td>141135.385006</td>
      <td>141131.922378</td>
      <td>141231.656466</td>
      <td>141115.855797</td>
      <td>141220.542768</td>
      <td>141162.097924</td>
      <td>141102.469348</td>
      <td>141206.299004</td>
      <td>141123.514021</td>
      <td>141192.723871</td>
      <td>141248.047431</td>
      <td>141207.440681</td>
      <td>141139.602971</td>
      <td>141157.554097</td>
      <td>141045.650680</td>
      <td>141139.907409</td>
      <td>140888.479585</td>
      <td>140995.832130</td>
      <td>141126.000693</td>
      <td>141195.104186</td>
      <td>141157.523028</td>
      <td>141105.662748</td>
      <td>141112.441533</td>
      <td>141293.285098</td>
      <td>141107.636577</td>
      <td>141054.134890</td>
      <td>141174.120525</td>
      <td>140912.054405</td>
      <td>140998.875288</td>
      <td>141227.024526</td>
      <td>141183.770462</td>
      <td>141301.178908</td>
      <td>141147.423729</td>
      <td>141100.943892</td>
      <td>141378.202818</td>
      <td>141228.656766</td>
      <td>141309.960163</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>62789.448650</td>
      <td>63084.529078</td>
      <td>62888.248116</td>
      <td>62879.160690</td>
      <td>62902.299203</td>
      <td>62856.785176</td>
      <td>62838.438216</td>
      <td>62890.327459</td>
      <td>62978.468824</td>
      <td>62915.586396</td>
      <td>63030.280126</td>
      <td>62972.033937</td>
      <td>63002.387872</td>
      <td>62917.744686</td>
      <td>62882.950698</td>
      <td>62963.445695</td>
      <td>63047.080991</td>
      <td>62936.457158</td>
      <td>62918.843671</td>
      <td>62903.944131</td>
      <td>62860.251827</td>
      <td>62981.319394</td>
      <td>62955.393306</td>
      <td>62950.430855</td>
      <td>62790.031253</td>
      <td>62864.886726</td>
      <td>62973.441523</td>
      <td>62832.014189</td>
      <td>62840.955762</td>
      <td>62894.206974</td>
      <td>62961.589149</td>
      <td>63016.263609</td>
      <td>62849.370593</td>
      <td>62860.779191</td>
      <td>62823.774972</td>
      <td>62836.445243</td>
      <td>62939.162851</td>
      <td>63026.291359</td>
      <td>63070.556424</td>
      <td>62920.886694</td>
      <td>...</td>
      <td>62681.452641</td>
      <td>62818.463320</td>
      <td>62658.489891</td>
      <td>62751.509989</td>
      <td>62673.658088</td>
      <td>62645.568598</td>
      <td>62681.461059</td>
      <td>62508.688815</td>
      <td>62410.438476</td>
      <td>62357.747106</td>
      <td>62424.788206</td>
      <td>62287.583036</td>
      <td>62463.003606</td>
      <td>62461.858904</td>
      <td>62661.955794</td>
      <td>62695.748268</td>
      <td>62763.846757</td>
      <td>62617.561068</td>
      <td>62713.372410</td>
      <td>62667.105538</td>
      <td>62616.660149</td>
      <td>62616.715432</td>
      <td>62717.656437</td>
      <td>62704.556538</td>
      <td>62715.951555</td>
      <td>62749.903309</td>
      <td>62744.565477</td>
      <td>62690.301100</td>
      <td>62640.328884</td>
      <td>62562.900647</td>
      <td>62681.503019</td>
      <td>62595.074849</td>
      <td>62785.115156</td>
      <td>62726.137782</td>
      <td>62662.004908</td>
      <td>62639.195962</td>
      <td>62595.452252</td>
      <td>62665.525918</td>
      <td>62690.144817</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>41432.330660</td>
      <td>41693.673194</td>
      <td>41615.060995</td>
      <td>41733.206360</td>
      <td>41407.073111</td>
      <td>41575.178851</td>
      <td>41481.167264</td>
      <td>41461.696150</td>
      <td>41574.132506</td>
      <td>41545.980086</td>
      <td>41589.135266</td>
      <td>41631.806337</td>
      <td>41678.861443</td>
      <td>41666.674866</td>
      <td>41573.258211</td>
      <td>41595.650027</td>
      <td>41704.488771</td>
      <td>41548.087189</td>
      <td>41514.108672</td>
      <td>41592.132381</td>
      <td>41587.728893</td>
      <td>41642.447618</td>
      <td>41577.163200</td>
      <td>41561.930921</td>
      <td>41516.422593</td>
      <td>41608.456849</td>
      <td>41626.788574</td>
      <td>41504.738696</td>
      <td>41597.093006</td>
      <td>41628.753414</td>
      <td>41551.683274</td>
      <td>41666.509823</td>
      <td>41582.059959</td>
      <td>41581.388399</td>
      <td>41583.151091</td>
      <td>41794.523488</td>
      <td>41602.794663</td>
      <td>41608.601705</td>
      <td>41609.603589</td>
      <td>41571.278191</td>
      <td>...</td>
      <td>40881.435582</td>
      <td>40843.288013</td>
      <td>40754.713626</td>
      <td>40845.671971</td>
      <td>40768.896734</td>
      <td>40795.521882</td>
      <td>40733.957968</td>
      <td>40801.082108</td>
      <td>40758.474369</td>
      <td>40777.197609</td>
      <td>40654.588433</td>
      <td>40805.613933</td>
      <td>40743.934771</td>
      <td>40834.311881</td>
      <td>40829.452126</td>
      <td>40898.833956</td>
      <td>40790.762090</td>
      <td>40842.380033</td>
      <td>40691.121858</td>
      <td>40828.179011</td>
      <td>40902.506017</td>
      <td>40846.943964</td>
      <td>40717.051200</td>
      <td>40755.964071</td>
      <td>40761.241218</td>
      <td>40749.390892</td>
      <td>40764.210918</td>
      <td>40783.309633</td>
      <td>40688.716724</td>
      <td>40899.485940</td>
      <td>40846.857493</td>
      <td>40836.554608</td>
      <td>40791.558598</td>
      <td>40873.087750</td>
      <td>40697.934377</td>
      <td>40749.979366</td>
      <td>40747.427558</td>
      <td>40981.845986</td>
      <td>40791.714704</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>75697.102041</td>
      <td>75521.999008</td>
      <td>75698.416356</td>
      <td>75705.738417</td>
      <td>75615.635709</td>
      <td>75589.288889</td>
      <td>75636.802773</td>
      <td>75605.037888</td>
      <td>75643.661031</td>
      <td>75676.159731</td>
      <td>75686.112903</td>
      <td>75529.686928</td>
      <td>75619.574181</td>
      <td>75598.209878</td>
      <td>75671.834220</td>
      <td>75653.166464</td>
      <td>75668.853037</td>
      <td>75677.115840</td>
      <td>75667.335173</td>
      <td>75869.542965</td>
      <td>75494.598934</td>
      <td>75647.836979</td>
      <td>75566.587210</td>
      <td>75589.594379</td>
      <td>75699.678912</td>
      <td>75702.470303</td>
      <td>75733.356330</td>
      <td>75581.316242</td>
      <td>75790.350131</td>
      <td>75540.179441</td>
      <td>75675.170180</td>
      <td>75585.319226</td>
      <td>75586.911065</td>
      <td>75641.780776</td>
      <td>75606.990303</td>
      <td>75701.682365</td>
      <td>75516.024677</td>
      <td>75547.293254</td>
      <td>75563.844719</td>
      <td>75755.697044</td>
      <td>...</td>
      <td>76268.041648</td>
      <td>76281.419232</td>
      <td>76284.440650</td>
      <td>76394.796219</td>
      <td>76213.197332</td>
      <td>76266.147764</td>
      <td>76103.233510</td>
      <td>76216.735548</td>
      <td>76239.222373</td>
      <td>76242.488306</td>
      <td>76374.396560</td>
      <td>76234.833050</td>
      <td>76231.972588</td>
      <td>76326.670377</td>
      <td>76266.439862</td>
      <td>76203.261758</td>
      <td>76211.216236</td>
      <td>76228.558971</td>
      <td>76245.008354</td>
      <td>76174.797288</td>
      <td>76321.157824</td>
      <td>76245.700392</td>
      <td>76255.793168</td>
      <td>76386.641211</td>
      <td>76193.530045</td>
      <td>76262.074742</td>
      <td>76154.024313</td>
      <td>76303.203262</td>
      <td>76377.507464</td>
      <td>76282.547285</td>
      <td>76156.168117</td>
      <td>76283.238530</td>
      <td>76317.845976</td>
      <td>76357.921520</td>
      <td>76262.509002</td>
      <td>76403.950151</td>
      <td>76152.819830</td>
      <td>76197.209589</td>
      <td>76313.579812</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 15051 columns</p>
</div></div>
</div>
<p>How many Labels we got ?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Labels =&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Counts =&#39;</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Labels = [0]
Counts = [496650]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Machine-Learning">
<h2>Machine Learning<a class="headerlink" href="#Machine-Learning" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3><strong>Preliminaries</strong><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id6">
<h3><strong>Splitting the dataset into the Training set and Test set</strong><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(24, 15050) (24,) (9, 15050) (9,)
</pre></div></div>
</div>
</div>
<div class="section" id="id7">
<h3><strong>Time Series Classification</strong><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;minkowski&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># from sklearn import svm</span>
<span class="c1"># classifier = svm.SVC()</span>

<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KNeighborsClassifier()
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[9]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="08%20-%20Phase%20Folded.html" class="btn btn-neutral float-left" title="Reading the data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Guilherme Samuel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>