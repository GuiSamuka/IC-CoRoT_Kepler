

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Machine Learning Data &mdash; Filtering Techniques</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Filtering Techniques" href="modules.html" />
    <link rel="prev" title="Reading the data" href="05%20-%20Feature%20Engineering.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Filtering Techniques of Light Curves Obtained from CoRoT and Kepler satellites
          

          
            
            <img src="_static/Logos_white_bg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manipulating fits files</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html">Read <em>.fits</em> data</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Knowing-and-fixing-the-header">Knowing and fixing the header</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Algorithms">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Preprocessing-data">Preprocessing data</a></li>
</ul>
<p class="caption"><span class="caption-text">Filter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="02%20-%20Filters.html">Frequency Domain Filtering Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="02%20-%20Filters.html#Nonlinear-filter">Nonlinear filter</a></li>
</ul>
<p class="caption"><span class="caption-text">Filtering processes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Study%20of%20filtering%20processes.html">Reading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Study%20of%20filtering%20processes.html#Ideal-Lowpass-Filter---Traduzir">Ideal Lowpass Filter - Traduzir</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Study%20of%20filtering%20processes.html#Gaussian-Lowpass-Filter">Gaussian Lowpass Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Study%20of%20filtering%20processes.html#Butterworth-Lowpass-Filter">Butterworth Lowpass Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Study%20of%20filtering%20processes.html#Bessel-Lowpass-Filter">Bessel Lowpass Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Study%20of%20filtering%20processes.html#Median-Filter">Median Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Study%20of%20filtering%20processes.html#API">API</a></li>
</ul>
<p class="caption"><span class="caption-text">Simulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Simulation.html">Lightkurve v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Simulation.html#Phase-Folded">Phase-Folded</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20Simulation.html#Simulation">Simulation</a></li>
</ul>
<p class="caption"><span class="caption-text">Feature Engineering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Feature%20Engineering.html">Reading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Feature%20Engineering.html#Feature:-Periodograms">Feature: Periodograms</a></li>
</ul>
<p class="caption"><span class="caption-text">Machine Learning</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Machine Learning Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="#SkTime">SkTime</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Preprocessing-data">Preprocessing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Creating-matrix-of-features-(CoRoT-targets-with-confirmed-exoplanets)">Creating matrix of features (CoRoT targets with confirmed exoplanets)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Labeling-matrix-of-features">Labeling matrix of features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-dataset,-X-and-y">Creating dataset, X and y</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Machine-Learning---SkTime">Machine Learning - SkTime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Preliminaries"><strong>Preliminaries</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Splitting-the-dataset-into-the-Training-set-and-Test-set"><strong>Splitting the dataset into the Training set and Test set</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Time-Series-Classification"><strong>Time Series Classification</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Feature-extraction"><strong>Feature extraction</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Time-Series-Classification-with-Feature-Extraction"><strong>Time Series Classification with Feature Extraction</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#SkLearn">SkLearn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Preprocessing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Creating matrix of features (CoRoT targets with confirmed exoplanets)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Labeling matrix of features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Creating dataset, X and y</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Machine-Learning">Machine Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5"><strong>Preliminaries</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6"><strong>Splitting the dataset into the Training set and Test set</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7"><strong>Time Series Classification</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Decision-Trees---0.57">Decision Trees - 0.57</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Feature:-Periodograms">Feature: Periodograms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Preprocessing">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Splitting the dataset into the Training set and Test set</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Train-model">Train model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Results">Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#XGBoost---0.585">XGBoost - 0.585</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id9">Feature: Periodograms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id10">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">Splitting the dataset into the Training set and Test set</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">Train model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id13">Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Gaussian-Mixture-Models">Gaussian Mixture Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id14">Feature: Periodograms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">Splitting the dataset into the Training set and Test set</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">Train model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id18">Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Lazy-Predict">Lazy Predict</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id19">Feature: Periodograms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id20">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">Splitting the dataset into the Training set and Test set</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">Train model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id23">Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Code Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Filtering Techniques</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Filtering Techniques of Light Curves Obtained from CoRoT and Kepler satellites</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Machine Learning Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/06 - Machine Learning.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Machine-Learning-Data">
<h1>Machine Learning Data<a class="headerlink" href="#Machine-Learning-Data" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Now, we are going to apply some ML algorithms on lightcurves contained:</p>
<ul class="simple">
<li><p>0: Confirmed Exoplanets</p></li>
<li><p>1: Eclipsing Binaries</p></li>
<li><p>2: Non Eclipsed</p></li>
</ul>
<p>With that in mind, the data from (1) and (2) will be downloaded from the <a class="reference external" href="http://idoc-corot.ias.u-psud.fr/sitools/client-user/COROT_N2_PUBLIC_DATA/project-index.html">CoRoT Public Archive</a> and transformed into CSV files, just like we did for (0): Confirmed Exoplanets on <code class="docutils literal notranslate"><span class="pre">01</span> <span class="pre">-</span> <span class="pre">Manipulating</span> <span class="pre">fits</span> <span class="pre">files</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="SkTime">
<h1>SkTime<a class="headerlink" href="#SkTime" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="o">!</span>pip install control
<span class="kn">from</span> <span class="nn">tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="Preprocessing-data">
<h2>Preprocessing data<a class="headerlink" href="#Preprocessing-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Creating-matrix-of-features-(CoRoT-targets-with-confirmed-exoplanets)">
<h3>Creating matrix of features (CoRoT targets with confirmed exoplanets)<a class="headerlink" href="#Creating-matrix-of-features-(CoRoT-targets-with-confirmed-exoplanets)" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># DATA_DIR = &#39;C:/Users/guisa/Google Drive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="c1"># DATA_DIR = &#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/resampled_files&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">root_dir_path</span><span class="p">,</span> <span class="n">sub_dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;desktop.ini&#39;</span> <span class="ow">and</span> <span class="s1">&#39;csv_files.rar&#39;</span><span class="p">):</span>
            <span class="c1"># File path</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">root_dir_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="c1"># Reading data</span>
            <span class="c1"># print(path)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">flux</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WHITEFLUX</span>

            <span class="c1"># Add timeseries to pd.DataFrame</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="n">flux</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time_series&#39;</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Labeling-matrix-of-features">
<h3>Labeling matrix of features<a class="headerlink" href="#Labeling-matrix-of-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>0: confirmed_exoplanets</p></li>
<li><p>1: eclipsing_binaries</p></li>
<li><p>2: none</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Creating-dataset,-X-and-y">
<h3>Creating dataset, X and y<a class="headerlink" href="#Creating-dataset,-X-and-y" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Creating pd.DataFrame with X data, and setted columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time_series&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">])</span>

<span class="c1"># Adding labels</span>
<span class="n">df</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">y</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>How many Labels we got ?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Labels =&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Counts =&#39;</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Machine-Learning---SkTime">
<h2>Machine Learning - SkTime<a class="headerlink" href="#Machine-Learning---SkTime" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/alan-turing-institute/sktime/tree/v0.4.3">https://github.com/alan-turing-institute/sktime/tree/v0.4.3</a></p>
<p><a class="reference external" href="https://github.com/alan-turing-institute/sktime/blob/main/sktime/classification/compose/">https://github.com/alan-turing-institute/sktime/blob/main/sktime/classification/compose/</a><strong>init</strong>.py</p>
<div class="section" id="Preliminaries">
<h3><strong>Preliminaries</strong><a class="headerlink" href="#Preliminaries" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># !pip install sktime[all_extras]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Splitting-the-dataset-into-the-Training-set-and-Test-set">
<h3><strong>Splitting the dataset into the Training set and Test set</strong><a class="headerlink" href="#Splitting-the-dataset-into-the-Training-set-and-Test-set" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(24, 1) (24,) (9, 1) (9,)
</pre></div></div>
</div>
</div>
<div class="section" id="Time-Series-Classification">
<h3><strong>Time Series Classification</strong><a class="headerlink" href="#Time-Series-Classification" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://towardsdatascience.com/sktime-a-unified-python-library-for-time-series-machine-learning-3c103c139a55">https://towardsdatascience.com/sktime-a-unified-python-library-for-time-series-machine-learning-3c103c139a55</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.classification.all</span> <span class="kn">import</span> <span class="n">TimeSeriesForestClassifier</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">TimeSeriesForestClassifier</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TimeSeriesForestClassifier()
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Feature-extraction">
<h3><strong>Feature extraction</strong><a class="headerlink" href="#Feature-extraction" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;statsmodels.tsa.ar_model.AR&#39;</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sktime.transformations.panel.tsfresh</span> <span class="kn">import</span> <span class="n">TSFreshFeatureExtractor</span>

<span class="n">transformer</span> <span class="o">=</span> <span class="n">TSFreshFeatureExtractor</span><span class="p">(</span><span class="n">default_fc_parameters</span><span class="o">=</span><span class="s2">&quot;minimal&quot;</span><span class="p">)</span>

<span class="n">extracted_features</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">extracted_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

Feature Extraction:   0%|          | 0/5 [00:00&lt;?, ?it/s]
Feature Extraction:  20%|██        | 1/5 [00:00&lt;00:00,  7.32it/s]
Feature Extraction: 100%|██████████| 5/5 [00:00&lt;00:00, 18.29it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time_series__sum_values</th>
      <th>time_series__median</th>
      <th>time_series__mean</th>
      <th>time_series__length</th>
      <th>time_series__standard_deviation</th>
      <th>time_series__variance</th>
      <th>time_series__root_mean_square</th>
      <th>time_series__maximum</th>
      <th>time_series__minimum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.124862e+09</td>
      <td>141218.330072</td>
      <td>141186.836848</td>
      <td>15050.0</td>
      <td>282.683706</td>
      <td>79910.077814</td>
      <td>141187.119841</td>
      <td>142021.360654</td>
      <td>138999.945791</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.136100e+08</td>
      <td>40704.273331</td>
      <td>40771.427763</td>
      <td>15050.0</td>
      <td>560.265206</td>
      <td>313897.101078</td>
      <td>40775.277055</td>
      <td>44921.695568</td>
      <td>39239.685767</td>
    </tr>
    <tr>
      <th>16</th>
      <td>6.258849e+08</td>
      <td>41653.547836</td>
      <td>41587.034197</td>
      <td>15050.0</td>
      <td>364.389989</td>
      <td>132780.064141</td>
      <td>41588.630578</td>
      <td>42472.076073</td>
      <td>40477.653465</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.512183e+09</td>
      <td>299686.539820</td>
      <td>299812.826420</td>
      <td>15050.0</td>
      <td>613.298072</td>
      <td>376134.525086</td>
      <td>299813.453701</td>
      <td>302311.608084</td>
      <td>297465.565232</td>
    </tr>
    <tr>
      <th>13</th>
      <td>5.857504e+08</td>
      <td>38822.561668</td>
      <td>38920.292034</td>
      <td>15050.0</td>
      <td>553.820584</td>
      <td>306717.239608</td>
      <td>38924.232160</td>
      <td>40531.501716</td>
      <td>37855.665849</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># If the result is 1, it means that the entire dataset has de same lenght</span>

<span class="n">extracted_features</span><span class="o">.</span><span class="n">time_series__length</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1
</pre></div></div>
</div>
</div>
<div class="section" id="Time-Series-Classification-with-Feature-Extraction">
<h3><strong>Time Series Classification with Feature Extraction</strong><a class="headerlink" href="#Time-Series-Classification-with-Feature-Extraction" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">TSFreshFeatureExtractor</span><span class="p">(</span><span class="n">show_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

Feature Extraction:   0%|          | 0/5 [00:00&lt;?, ?it/s]
Feature Extraction:  20%|██        | 1/5 [01:28&lt;05:53, 88.44s/it]
Feature Extraction:  40%|████      | 2/5 [03:13&lt;04:40, 93.37s/it]
Feature Extraction:  60%|██████    | 3/5 [04:51&lt;03:09, 94.94s/it]
Feature Extraction:  80%|████████  | 4/5 [06:30&lt;01:36, 96.16s/it]
Feature Extraction: 100%|██████████| 5/5 [07:48&lt;00:00, 93.60s/it]

Feature Extraction:   0%|          | 0/5 [00:00&lt;?, ?it/s]
Feature Extraction:  20%|██        | 1/5 [00:45&lt;03:02, 45.55s/it]
Feature Extraction:  40%|████      | 2/5 [01:17&lt;02:03, 41.33s/it]
Feature Extraction:  60%|██████    | 3/5 [01:52&lt;01:18, 39.44s/it]
Feature Extraction:  80%|████████  | 4/5 [02:32&lt;00:39, 39.77s/it]
Feature Extraction: 100%|██████████| 5/5 [02:50&lt;00:00, 34.17s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="SkLearn">
<h1>SkLearn<a class="headerlink" href="#SkLearn" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="o">!</span>pip install control
<span class="kn">from</span> <span class="nn">tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>Preprocessing data<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Creating matrix of features (CoRoT targets with confirmed exoplanets)<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># DATA_DIR = &#39;C:/Users/guisa/Google Drive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="c1"># DATA_DIR = &#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/csv_files&#39;</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/resampled_files&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">root_dir_path</span><span class="p">,</span> <span class="n">sub_dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;desktop.ini&#39;</span> <span class="ow">and</span> <span class="s1">&#39;csv_files.rar&#39;</span><span class="p">):</span>
            <span class="c1"># File path</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">root_dir_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="c1"># Reading data</span>
            <span class="c1"># print(path)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">flux</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">WHITEFLUX</span>

            <span class="c1"># Add timeseries to pd.DataFrame</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>15010</th>
      <th>15011</th>
      <th>15012</th>
      <th>15013</th>
      <th>15014</th>
      <th>15015</th>
      <th>15016</th>
      <th>15017</th>
      <th>15018</th>
      <th>15019</th>
      <th>15020</th>
      <th>15021</th>
      <th>15022</th>
      <th>15023</th>
      <th>15024</th>
      <th>15025</th>
      <th>15026</th>
      <th>15027</th>
      <th>15028</th>
      <th>15029</th>
      <th>15030</th>
      <th>15031</th>
      <th>15032</th>
      <th>15033</th>
      <th>15034</th>
      <th>15035</th>
      <th>15036</th>
      <th>15037</th>
      <th>15038</th>
      <th>15039</th>
      <th>15040</th>
      <th>15041</th>
      <th>15042</th>
      <th>15043</th>
      <th>15044</th>
      <th>15045</th>
      <th>15046</th>
      <th>15047</th>
      <th>15048</th>
      <th>15049</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.411572e+05</td>
      <td>1.412424e+05</td>
      <td>1.411326e+05</td>
      <td>1.413731e+05</td>
      <td>1.412133e+05</td>
      <td>1.413579e+05</td>
      <td>1.411959e+05</td>
      <td>1.412497e+05</td>
      <td>1.413829e+05</td>
      <td>1.414096e+05</td>
      <td>1.412703e+05</td>
      <td>1.412327e+05</td>
      <td>1.411492e+05</td>
      <td>1.412873e+05</td>
      <td>1.412144e+05</td>
      <td>1.411442e+05</td>
      <td>1.412001e+05</td>
      <td>1.412225e+05</td>
      <td>1.413235e+05</td>
      <td>1.412076e+05</td>
      <td>1.411856e+05</td>
      <td>1.411647e+05</td>
      <td>1.412128e+05</td>
      <td>1.413366e+05</td>
      <td>1.412635e+05</td>
      <td>1.413088e+05</td>
      <td>1.413307e+05</td>
      <td>1.411438e+05</td>
      <td>1.412988e+05</td>
      <td>1.411502e+05</td>
      <td>1.411364e+05</td>
      <td>1.414083e+05</td>
      <td>1.410876e+05</td>
      <td>1.411729e+05</td>
      <td>1.412924e+05</td>
      <td>1.413673e+05</td>
      <td>1.412330e+05</td>
      <td>1.411206e+05</td>
      <td>1.413310e+05</td>
      <td>1.411721e+05</td>
      <td>...</td>
      <td>1.411859e+05</td>
      <td>1.411025e+05</td>
      <td>1.410474e+05</td>
      <td>1.411354e+05</td>
      <td>1.411319e+05</td>
      <td>1.412317e+05</td>
      <td>1.411159e+05</td>
      <td>1.412205e+05</td>
      <td>1.411621e+05</td>
      <td>1.411025e+05</td>
      <td>1.412063e+05</td>
      <td>1.411235e+05</td>
      <td>1.411927e+05</td>
      <td>1.412480e+05</td>
      <td>1.412074e+05</td>
      <td>1.411396e+05</td>
      <td>1.411576e+05</td>
      <td>1.410457e+05</td>
      <td>1.411399e+05</td>
      <td>1.408885e+05</td>
      <td>1.409958e+05</td>
      <td>1.411260e+05</td>
      <td>1.411951e+05</td>
      <td>1.411575e+05</td>
      <td>1.411057e+05</td>
      <td>1.411124e+05</td>
      <td>1.412933e+05</td>
      <td>1.411076e+05</td>
      <td>1.410541e+05</td>
      <td>1.411741e+05</td>
      <td>1.409121e+05</td>
      <td>1.409989e+05</td>
      <td>1.412270e+05</td>
      <td>1.411838e+05</td>
      <td>1.413012e+05</td>
      <td>1.411474e+05</td>
      <td>1.411009e+05</td>
      <td>1.413782e+05</td>
      <td>1.412287e+05</td>
      <td>1.413100e+05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.605181e+04</td>
      <td>2.611330e+04</td>
      <td>2.601663e+04</td>
      <td>2.614152e+04</td>
      <td>2.587125e+04</td>
      <td>2.587146e+04</td>
      <td>2.602901e+04</td>
      <td>2.604010e+04</td>
      <td>2.611140e+04</td>
      <td>2.607349e+04</td>
      <td>2.612061e+04</td>
      <td>2.601961e+04</td>
      <td>2.608381e+04</td>
      <td>2.615512e+04</td>
      <td>2.605209e+04</td>
      <td>2.615393e+04</td>
      <td>2.595893e+04</td>
      <td>2.613356e+04</td>
      <td>2.608572e+04</td>
      <td>2.604287e+04</td>
      <td>2.609076e+04</td>
      <td>2.603981e+04</td>
      <td>2.604673e+04</td>
      <td>2.605018e+04</td>
      <td>2.605711e+04</td>
      <td>2.603637e+04</td>
      <td>2.602297e+04</td>
      <td>2.610288e+04</td>
      <td>2.599291e+04</td>
      <td>2.599706e+04</td>
      <td>2.596696e+04</td>
      <td>2.610334e+04</td>
      <td>2.616852e+04</td>
      <td>2.615221e+04</td>
      <td>2.600709e+04</td>
      <td>2.604340e+04</td>
      <td>2.602915e+04</td>
      <td>2.623798e+04</td>
      <td>2.596439e+04</td>
      <td>2.610146e+04</td>
      <td>...</td>
      <td>2.621469e+04</td>
      <td>2.632878e+04</td>
      <td>2.624308e+04</td>
      <td>2.622704e+04</td>
      <td>2.618278e+04</td>
      <td>2.624397e+04</td>
      <td>2.632099e+04</td>
      <td>2.627644e+04</td>
      <td>2.625360e+04</td>
      <td>2.632872e+04</td>
      <td>2.625611e+04</td>
      <td>2.633979e+04</td>
      <td>2.629440e+04</td>
      <td>2.627620e+04</td>
      <td>2.635345e+04</td>
      <td>2.628232e+04</td>
      <td>2.634446e+04</td>
      <td>2.636739e+04</td>
      <td>2.625771e+04</td>
      <td>2.648313e+04</td>
      <td>2.638753e+04</td>
      <td>2.626968e+04</td>
      <td>2.623826e+04</td>
      <td>2.630487e+04</td>
      <td>2.624348e+04</td>
      <td>2.638560e+04</td>
      <td>2.620561e+04</td>
      <td>2.630678e+04</td>
      <td>2.627786e+04</td>
      <td>2.616603e+04</td>
      <td>2.631367e+04</td>
      <td>2.620188e+04</td>
      <td>2.618542e+04</td>
      <td>2.624512e+04</td>
      <td>2.625785e+04</td>
      <td>2.642315e+04</td>
      <td>2.621238e+04</td>
      <td>2.636027e+04</td>
      <td>2.629231e+04</td>
      <td>2.618336e+04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.298393e+06</td>
      <td>1.299550e+06</td>
      <td>1.299725e+06</td>
      <td>1.299612e+06</td>
      <td>1.299747e+06</td>
      <td>1.299215e+06</td>
      <td>1.299576e+06</td>
      <td>1.299769e+06</td>
      <td>1.299262e+06</td>
      <td>1.299409e+06</td>
      <td>1.299280e+06</td>
      <td>1.299889e+06</td>
      <td>1.299150e+06</td>
      <td>1.299826e+06</td>
      <td>1.298902e+06</td>
      <td>1.299552e+06</td>
      <td>1.299346e+06</td>
      <td>1.298708e+06</td>
      <td>1.299628e+06</td>
      <td>1.299107e+06</td>
      <td>1.299239e+06</td>
      <td>1.299363e+06</td>
      <td>1.299605e+06</td>
      <td>1.299160e+06</td>
      <td>1.299955e+06</td>
      <td>1.299210e+06</td>
      <td>1.299477e+06</td>
      <td>1.299130e+06</td>
      <td>1.299318e+06</td>
      <td>1.298997e+06</td>
      <td>1.299127e+06</td>
      <td>1.299335e+06</td>
      <td>1.299339e+06</td>
      <td>1.299389e+06</td>
      <td>1.299585e+06</td>
      <td>1.299507e+06</td>
      <td>1.298837e+06</td>
      <td>1.299754e+06</td>
      <td>1.298997e+06</td>
      <td>1.300436e+06</td>
      <td>...</td>
      <td>1.295584e+06</td>
      <td>1.296259e+06</td>
      <td>1.295880e+06</td>
      <td>1.296397e+06</td>
      <td>1.295613e+06</td>
      <td>1.295237e+06</td>
      <td>1.295789e+06</td>
      <td>1.295417e+06</td>
      <td>1.295453e+06</td>
      <td>1.295508e+06</td>
      <td>1.295937e+06</td>
      <td>1.294957e+06</td>
      <td>1.295125e+06</td>
      <td>1.294599e+06</td>
      <td>1.294709e+06</td>
      <td>1.295073e+06</td>
      <td>1.295429e+06</td>
      <td>1.295154e+06</td>
      <td>1.295264e+06</td>
      <td>1.295769e+06</td>
      <td>1.295695e+06</td>
      <td>1.295337e+06</td>
      <td>1.295557e+06</td>
      <td>1.295314e+06</td>
      <td>1.295710e+06</td>
      <td>1.295153e+06</td>
      <td>1.295031e+06</td>
      <td>1.295029e+06</td>
      <td>1.295460e+06</td>
      <td>1.295186e+06</td>
      <td>1.294849e+06</td>
      <td>1.295283e+06</td>
      <td>1.294897e+06</td>
      <td>1.294750e+06</td>
      <td>1.294881e+06</td>
      <td>1.294939e+06</td>
      <td>1.295167e+06</td>
      <td>1.295158e+06</td>
      <td>1.295069e+06</td>
      <td>1.294454e+06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.125213e+05</td>
      <td>1.127580e+05</td>
      <td>1.129430e+05</td>
      <td>1.125623e+05</td>
      <td>1.127893e+05</td>
      <td>1.125752e+05</td>
      <td>1.127852e+05</td>
      <td>1.126351e+05</td>
      <td>1.126462e+05</td>
      <td>1.126747e+05</td>
      <td>1.128206e+05</td>
      <td>1.126230e+05</td>
      <td>1.127497e+05</td>
      <td>1.127325e+05</td>
      <td>1.127567e+05</td>
      <td>1.127885e+05</td>
      <td>1.126766e+05</td>
      <td>1.127609e+05</td>
      <td>1.125398e+05</td>
      <td>1.127966e+05</td>
      <td>1.126471e+05</td>
      <td>1.126480e+05</td>
      <td>1.128501e+05</td>
      <td>1.128040e+05</td>
      <td>1.127078e+05</td>
      <td>1.128669e+05</td>
      <td>1.126771e+05</td>
      <td>1.127147e+05</td>
      <td>1.127916e+05</td>
      <td>1.126816e+05</td>
      <td>1.127761e+05</td>
      <td>1.126781e+05</td>
      <td>1.127678e+05</td>
      <td>1.127868e+05</td>
      <td>1.125911e+05</td>
      <td>1.127481e+05</td>
      <td>1.127409e+05</td>
      <td>1.126717e+05</td>
      <td>1.126739e+05</td>
      <td>1.125557e+05</td>
      <td>...</td>
      <td>1.124980e+05</td>
      <td>1.125445e+05</td>
      <td>1.125411e+05</td>
      <td>1.125625e+05</td>
      <td>1.124583e+05</td>
      <td>1.125062e+05</td>
      <td>1.123094e+05</td>
      <td>1.126122e+05</td>
      <td>1.126024e+05</td>
      <td>1.123122e+05</td>
      <td>1.125150e+05</td>
      <td>1.124099e+05</td>
      <td>1.124539e+05</td>
      <td>1.123920e+05</td>
      <td>1.124828e+05</td>
      <td>1.124690e+05</td>
      <td>1.125900e+05</td>
      <td>1.125468e+05</td>
      <td>1.123983e+05</td>
      <td>1.125112e+05</td>
      <td>1.124692e+05</td>
      <td>1.124070e+05</td>
      <td>1.125379e+05</td>
      <td>1.124257e+05</td>
      <td>1.125522e+05</td>
      <td>1.124184e+05</td>
      <td>1.125103e+05</td>
      <td>1.123842e+05</td>
      <td>1.126233e+05</td>
      <td>1.123789e+05</td>
      <td>1.123924e+05</td>
      <td>1.123847e+05</td>
      <td>1.125097e+05</td>
      <td>1.125469e+05</td>
      <td>1.124996e+05</td>
      <td>1.125005e+05</td>
      <td>1.124207e+05</td>
      <td>1.124281e+05</td>
      <td>1.124471e+05</td>
      <td>1.123491e+05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.064368e+04</td>
      <td>4.024597e+04</td>
      <td>4.043663e+04</td>
      <td>4.031514e+04</td>
      <td>4.029457e+04</td>
      <td>4.023700e+04</td>
      <td>4.029928e+04</td>
      <td>4.044337e+04</td>
      <td>4.056287e+04</td>
      <td>4.024665e+04</td>
      <td>4.043309e+04</td>
      <td>4.036776e+04</td>
      <td>4.041253e+04</td>
      <td>4.034370e+04</td>
      <td>4.067833e+04</td>
      <td>4.021538e+04</td>
      <td>4.045781e+04</td>
      <td>4.032538e+04</td>
      <td>4.037169e+04</td>
      <td>4.034290e+04</td>
      <td>4.028767e+04</td>
      <td>4.024320e+04</td>
      <td>4.023320e+04</td>
      <td>4.024396e+04</td>
      <td>4.034883e+04</td>
      <td>4.034518e+04</td>
      <td>4.028057e+04</td>
      <td>4.029106e+04</td>
      <td>4.048474e+04</td>
      <td>4.029657e+04</td>
      <td>4.035592e+04</td>
      <td>4.021696e+04</td>
      <td>4.020960e+04</td>
      <td>4.021597e+04</td>
      <td>4.026372e+04</td>
      <td>4.027219e+04</td>
      <td>4.024717e+04</td>
      <td>4.023869e+04</td>
      <td>4.038073e+04</td>
      <td>4.031858e+04</td>
      <td>...</td>
      <td>4.300994e+04</td>
      <td>4.303990e+04</td>
      <td>4.306673e+04</td>
      <td>4.301858e+04</td>
      <td>4.267300e+04</td>
      <td>4.247712e+04</td>
      <td>4.262169e+04</td>
      <td>4.277094e+04</td>
      <td>4.303920e+04</td>
      <td>4.267297e+04</td>
      <td>4.267512e+04</td>
      <td>4.263271e+04</td>
      <td>4.274761e+04</td>
      <td>4.247607e+04</td>
      <td>4.258747e+04</td>
      <td>4.217027e+04</td>
      <td>4.206883e+04</td>
      <td>4.236280e+04</td>
      <td>4.214163e+04</td>
      <td>4.226997e+04</td>
      <td>4.200494e+04</td>
      <td>4.193790e+04</td>
      <td>4.209874e+04</td>
      <td>4.221375e+04</td>
      <td>4.254759e+04</td>
      <td>4.279462e+04</td>
      <td>4.288303e+04</td>
      <td>4.289924e+04</td>
      <td>4.287694e+04</td>
      <td>4.282583e+04</td>
      <td>4.266600e+04</td>
      <td>4.277455e+04</td>
      <td>4.272497e+04</td>
      <td>4.275998e+04</td>
      <td>4.296628e+04</td>
      <td>4.300132e+04</td>
      <td>4.278209e+04</td>
      <td>4.265919e+04</td>
      <td>4.269699e+04</td>
      <td>4.274217e+04</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 15050 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(33, 15050)
</pre></div></div>
</div>
</div>
<div class="section" id="id3">
<h3>Labeling matrix of features<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>0: confirmed_exoplanets</p></li>
<li><p>1: eclipsing_binaries</p></li>
<li><p>2: none</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0, 0, 0, ..., 0, 0, 0])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    0
1    0
2    0
3    0
4    0
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(496650,)
</pre></div></div>
</div>
</div>
<div class="section" id="id4">
<h3>Creating dataset, X and y<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Creating pd.DataFrame with X data, and setted columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Adding labels</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>15011</th>
      <th>15012</th>
      <th>15013</th>
      <th>15014</th>
      <th>15015</th>
      <th>15016</th>
      <th>15017</th>
      <th>15018</th>
      <th>15019</th>
      <th>15020</th>
      <th>15021</th>
      <th>15022</th>
      <th>15023</th>
      <th>15024</th>
      <th>15025</th>
      <th>15026</th>
      <th>15027</th>
      <th>15028</th>
      <th>15029</th>
      <th>15030</th>
      <th>15031</th>
      <th>15032</th>
      <th>15033</th>
      <th>15034</th>
      <th>15035</th>
      <th>15036</th>
      <th>15037</th>
      <th>15038</th>
      <th>15039</th>
      <th>15040</th>
      <th>15041</th>
      <th>15042</th>
      <th>15043</th>
      <th>15044</th>
      <th>15045</th>
      <th>15046</th>
      <th>15047</th>
      <th>15048</th>
      <th>15049</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>30819.826000</td>
      <td>30766.330239</td>
      <td>30751.556425</td>
      <td>30749.078411</td>
      <td>30735.472031</td>
      <td>30705.364719</td>
      <td>30673.455704</td>
      <td>30662.058557</td>
      <td>30682.811774</td>
      <td>30726.006400</td>
      <td>30766.044428</td>
      <td>30779.528462</td>
      <td>30762.480430</td>
      <td>30733.670298</td>
      <td>30721.967523</td>
      <td>30747.701120</td>
      <td>30810.995926</td>
      <td>30892.582773</td>
      <td>30963.134137</td>
      <td>30994.637790</td>
      <td>30971.285524</td>
      <td>30899.489245</td>
      <td>30812.158646</td>
      <td>30757.956592</td>
      <td>30773.076489</td>
      <td>30850.996851</td>
      <td>30937.516699</td>
      <td>30965.531315</td>
      <td>30909.779524</td>
      <td>30815.873666</td>
      <td>30770.754493</td>
      <td>30830.580119</td>
      <td>30965.570660</td>
      <td>31074.862790</td>
      <td>31066.062397</td>
      <td>30933.718685</td>
      <td>30766.639144</td>
      <td>30675.022829</td>
      <td>30700.963010</td>
      <td>30791.397016</td>
      <td>...</td>
      <td>31257.034885</td>
      <td>31264.336563</td>
      <td>31300.065245</td>
      <td>31342.684879</td>
      <td>31375.525377</td>
      <td>31386.046775</td>
      <td>31362.258516</td>
      <td>31301.359103</td>
      <td>31225.968013</td>
      <td>31185.069625</td>
      <td>31225.200043</td>
      <td>31348.360808</td>
      <td>31494.844160</td>
      <td>31574.995403</td>
      <td>31532.203536</td>
      <td>31387.986425</td>
      <td>31230.251847</td>
      <td>31151.297131</td>
      <td>31183.599756</td>
      <td>31282.844881</td>
      <td>31368.501950</td>
      <td>31386.865644</td>
      <td>31347.153080</td>
      <td>31306.651124</td>
      <td>31321.815477</td>
      <td>31405.234907</td>
      <td>31518.720306</td>
      <td>31602.739344</td>
      <td>31617.101315</td>
      <td>31564.063024</td>
      <td>31481.233700</td>
      <td>31413.127641</td>
      <td>31382.205800</td>
      <td>31377.323280</td>
      <td>31364.368751</td>
      <td>31310.075393</td>
      <td>31203.441067</td>
      <td>31062.404104</td>
      <td>30923.186993</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>141157.216020</td>
      <td>141242.434636</td>
      <td>141132.564812</td>
      <td>141373.143346</td>
      <td>141213.262888</td>
      <td>141357.927056</td>
      <td>141195.854576</td>
      <td>141249.723060</td>
      <td>141382.882136</td>
      <td>141409.646127</td>
      <td>141270.347310</td>
      <td>141232.742194</td>
      <td>141149.203020</td>
      <td>141287.347367</td>
      <td>141214.443625</td>
      <td>141144.196655</td>
      <td>141200.096238</td>
      <td>141222.533249</td>
      <td>141323.471805</td>
      <td>141207.648435</td>
      <td>141185.552578</td>
      <td>141164.668742</td>
      <td>141212.764561</td>
      <td>141336.627107</td>
      <td>141263.521595</td>
      <td>141308.810296</td>
      <td>141330.700205</td>
      <td>141143.809870</td>
      <td>141298.757841</td>
      <td>141150.205593</td>
      <td>141136.397407</td>
      <td>141408.260213</td>
      <td>141087.606264</td>
      <td>141172.925450</td>
      <td>141292.442324</td>
      <td>141367.329433</td>
      <td>141232.994283</td>
      <td>141120.579153</td>
      <td>141330.990802</td>
      <td>141172.077723</td>
      <td>...</td>
      <td>141102.476944</td>
      <td>141047.400969</td>
      <td>141135.385006</td>
      <td>141131.922378</td>
      <td>141231.656466</td>
      <td>141115.855797</td>
      <td>141220.542768</td>
      <td>141162.097924</td>
      <td>141102.469348</td>
      <td>141206.299004</td>
      <td>141123.514021</td>
      <td>141192.723871</td>
      <td>141248.047431</td>
      <td>141207.440681</td>
      <td>141139.602971</td>
      <td>141157.554097</td>
      <td>141045.650680</td>
      <td>141139.907409</td>
      <td>140888.479585</td>
      <td>140995.832130</td>
      <td>141126.000693</td>
      <td>141195.104186</td>
      <td>141157.523028</td>
      <td>141105.662748</td>
      <td>141112.441533</td>
      <td>141293.285098</td>
      <td>141107.636577</td>
      <td>141054.134890</td>
      <td>141174.120525</td>
      <td>140912.054405</td>
      <td>140998.875288</td>
      <td>141227.024526</td>
      <td>141183.770462</td>
      <td>141301.178908</td>
      <td>141147.423729</td>
      <td>141100.943892</td>
      <td>141378.202818</td>
      <td>141228.656766</td>
      <td>141309.960163</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>62789.448650</td>
      <td>63084.529078</td>
      <td>62888.248116</td>
      <td>62879.160690</td>
      <td>62902.299203</td>
      <td>62856.785176</td>
      <td>62838.438216</td>
      <td>62890.327459</td>
      <td>62978.468824</td>
      <td>62915.586396</td>
      <td>63030.280126</td>
      <td>62972.033937</td>
      <td>63002.387872</td>
      <td>62917.744686</td>
      <td>62882.950698</td>
      <td>62963.445695</td>
      <td>63047.080991</td>
      <td>62936.457158</td>
      <td>62918.843671</td>
      <td>62903.944131</td>
      <td>62860.251827</td>
      <td>62981.319394</td>
      <td>62955.393306</td>
      <td>62950.430855</td>
      <td>62790.031253</td>
      <td>62864.886726</td>
      <td>62973.441523</td>
      <td>62832.014189</td>
      <td>62840.955762</td>
      <td>62894.206974</td>
      <td>62961.589149</td>
      <td>63016.263609</td>
      <td>62849.370593</td>
      <td>62860.779191</td>
      <td>62823.774972</td>
      <td>62836.445243</td>
      <td>62939.162851</td>
      <td>63026.291359</td>
      <td>63070.556424</td>
      <td>62920.886694</td>
      <td>...</td>
      <td>62681.452641</td>
      <td>62818.463320</td>
      <td>62658.489891</td>
      <td>62751.509989</td>
      <td>62673.658088</td>
      <td>62645.568598</td>
      <td>62681.461059</td>
      <td>62508.688815</td>
      <td>62410.438476</td>
      <td>62357.747106</td>
      <td>62424.788206</td>
      <td>62287.583036</td>
      <td>62463.003606</td>
      <td>62461.858904</td>
      <td>62661.955794</td>
      <td>62695.748268</td>
      <td>62763.846757</td>
      <td>62617.561068</td>
      <td>62713.372410</td>
      <td>62667.105538</td>
      <td>62616.660149</td>
      <td>62616.715432</td>
      <td>62717.656437</td>
      <td>62704.556538</td>
      <td>62715.951555</td>
      <td>62749.903309</td>
      <td>62744.565477</td>
      <td>62690.301100</td>
      <td>62640.328884</td>
      <td>62562.900647</td>
      <td>62681.503019</td>
      <td>62595.074849</td>
      <td>62785.115156</td>
      <td>62726.137782</td>
      <td>62662.004908</td>
      <td>62639.195962</td>
      <td>62595.452252</td>
      <td>62665.525918</td>
      <td>62690.144817</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>41432.330660</td>
      <td>41693.673194</td>
      <td>41615.060995</td>
      <td>41733.206360</td>
      <td>41407.073111</td>
      <td>41575.178851</td>
      <td>41481.167264</td>
      <td>41461.696150</td>
      <td>41574.132506</td>
      <td>41545.980086</td>
      <td>41589.135266</td>
      <td>41631.806337</td>
      <td>41678.861443</td>
      <td>41666.674866</td>
      <td>41573.258211</td>
      <td>41595.650027</td>
      <td>41704.488771</td>
      <td>41548.087189</td>
      <td>41514.108672</td>
      <td>41592.132381</td>
      <td>41587.728893</td>
      <td>41642.447618</td>
      <td>41577.163200</td>
      <td>41561.930921</td>
      <td>41516.422593</td>
      <td>41608.456849</td>
      <td>41626.788574</td>
      <td>41504.738696</td>
      <td>41597.093006</td>
      <td>41628.753414</td>
      <td>41551.683274</td>
      <td>41666.509823</td>
      <td>41582.059959</td>
      <td>41581.388399</td>
      <td>41583.151091</td>
      <td>41794.523488</td>
      <td>41602.794663</td>
      <td>41608.601705</td>
      <td>41609.603589</td>
      <td>41571.278191</td>
      <td>...</td>
      <td>40881.435582</td>
      <td>40843.288013</td>
      <td>40754.713626</td>
      <td>40845.671971</td>
      <td>40768.896734</td>
      <td>40795.521882</td>
      <td>40733.957968</td>
      <td>40801.082108</td>
      <td>40758.474369</td>
      <td>40777.197609</td>
      <td>40654.588433</td>
      <td>40805.613933</td>
      <td>40743.934771</td>
      <td>40834.311881</td>
      <td>40829.452126</td>
      <td>40898.833956</td>
      <td>40790.762090</td>
      <td>40842.380033</td>
      <td>40691.121858</td>
      <td>40828.179011</td>
      <td>40902.506017</td>
      <td>40846.943964</td>
      <td>40717.051200</td>
      <td>40755.964071</td>
      <td>40761.241218</td>
      <td>40749.390892</td>
      <td>40764.210918</td>
      <td>40783.309633</td>
      <td>40688.716724</td>
      <td>40899.485940</td>
      <td>40846.857493</td>
      <td>40836.554608</td>
      <td>40791.558598</td>
      <td>40873.087750</td>
      <td>40697.934377</td>
      <td>40749.979366</td>
      <td>40747.427558</td>
      <td>40981.845986</td>
      <td>40791.714704</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>75697.102041</td>
      <td>75521.999008</td>
      <td>75698.416356</td>
      <td>75705.738417</td>
      <td>75615.635709</td>
      <td>75589.288889</td>
      <td>75636.802773</td>
      <td>75605.037888</td>
      <td>75643.661031</td>
      <td>75676.159731</td>
      <td>75686.112903</td>
      <td>75529.686928</td>
      <td>75619.574181</td>
      <td>75598.209878</td>
      <td>75671.834220</td>
      <td>75653.166464</td>
      <td>75668.853037</td>
      <td>75677.115840</td>
      <td>75667.335173</td>
      <td>75869.542965</td>
      <td>75494.598934</td>
      <td>75647.836979</td>
      <td>75566.587210</td>
      <td>75589.594379</td>
      <td>75699.678912</td>
      <td>75702.470303</td>
      <td>75733.356330</td>
      <td>75581.316242</td>
      <td>75790.350131</td>
      <td>75540.179441</td>
      <td>75675.170180</td>
      <td>75585.319226</td>
      <td>75586.911065</td>
      <td>75641.780776</td>
      <td>75606.990303</td>
      <td>75701.682365</td>
      <td>75516.024677</td>
      <td>75547.293254</td>
      <td>75563.844719</td>
      <td>75755.697044</td>
      <td>...</td>
      <td>76268.041648</td>
      <td>76281.419232</td>
      <td>76284.440650</td>
      <td>76394.796219</td>
      <td>76213.197332</td>
      <td>76266.147764</td>
      <td>76103.233510</td>
      <td>76216.735548</td>
      <td>76239.222373</td>
      <td>76242.488306</td>
      <td>76374.396560</td>
      <td>76234.833050</td>
      <td>76231.972588</td>
      <td>76326.670377</td>
      <td>76266.439862</td>
      <td>76203.261758</td>
      <td>76211.216236</td>
      <td>76228.558971</td>
      <td>76245.008354</td>
      <td>76174.797288</td>
      <td>76321.157824</td>
      <td>76245.700392</td>
      <td>76255.793168</td>
      <td>76386.641211</td>
      <td>76193.530045</td>
      <td>76262.074742</td>
      <td>76154.024313</td>
      <td>76303.203262</td>
      <td>76377.507464</td>
      <td>76282.547285</td>
      <td>76156.168117</td>
      <td>76283.238530</td>
      <td>76317.845976</td>
      <td>76357.921520</td>
      <td>76262.509002</td>
      <td>76403.950151</td>
      <td>76152.819830</td>
      <td>76197.209589</td>
      <td>76313.579812</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 15051 columns</p>
</div></div>
</div>
<p>How many Labels we got ?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Labels =&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Counts =&#39;</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Labels = [0]
Counts = [496650]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Machine-Learning">
<h2>Machine Learning<a class="headerlink" href="#Machine-Learning" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3><strong>Preliminaries</strong><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id6">
<h3><strong>Splitting the dataset into the Training set and Test set</strong><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(24, 15050) (24,) (9, 15050) (9,)
</pre></div></div>
</div>
</div>
<div class="section" id="id7">
<h3><strong>Time Series Classification</strong><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;minkowski&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># from sklearn import svm</span>
<span class="c1"># classifier = svm.SVC()</span>

<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KNeighborsClassifier()
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[9]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="Decision-Trees---0.57">
<h1>Decision Trees - 0.57<a class="headerlink" href="#Decision-Trees---0.57" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html">https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html</a></p>
<div class="section" id="Feature:-Periodograms">
<h2>Feature: Periodograms<a class="headerlink" href="#Feature:-Periodograms" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">FEATURES_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/features&#39;</span>
<span class="n">PERIODOGRAMS_DIR</span> <span class="o">=</span> <span class="n">FEATURES_DIR</span> <span class="o">+</span> <span class="s1">&#39;/feature_periodograms.csv&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">PERIODOGRAMS_DIR</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>7487</th>
      <th>7488</th>
      <th>7489</th>
      <th>7490</th>
      <th>7491</th>
      <th>7492</th>
      <th>7493</th>
      <th>7494</th>
      <th>7495</th>
      <th>7496</th>
      <th>7497</th>
      <th>7498</th>
      <th>7499</th>
      <th>7500</th>
      <th>7501</th>
      <th>7502</th>
      <th>7503</th>
      <th>7504</th>
      <th>7505</th>
      <th>7506</th>
      <th>7507</th>
      <th>7508</th>
      <th>7509</th>
      <th>7510</th>
      <th>7511</th>
      <th>7512</th>
      <th>7513</th>
      <th>7514</th>
      <th>7515</th>
      <th>7516</th>
      <th>7517</th>
      <th>7518</th>
      <th>7519</th>
      <th>7520</th>
      <th>7521</th>
      <th>7522</th>
      <th>7523</th>
      <th>7524</th>
      <th>7525</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>127</th>
      <td>1.771419e-21</td>
      <td>3.118507e+10</td>
      <td>1.792958e+10</td>
      <td>1.571999e+10</td>
      <td>1.392014e+10</td>
      <td>3.661464e+10</td>
      <td>1.002512e+10</td>
      <td>1.852784e+10</td>
      <td>1.907169e+10</td>
      <td>1.278961e+10</td>
      <td>2.216953e+09</td>
      <td>9.314578e+09</td>
      <td>6.515043e+09</td>
      <td>3.546007e+09</td>
      <td>4.409342e+09</td>
      <td>9.162630e+09</td>
      <td>8.302242e+09</td>
      <td>8.718788e+09</td>
      <td>6.957977e+09</td>
      <td>5.611064e+09</td>
      <td>1.877066e+09</td>
      <td>2.836627e+09</td>
      <td>2.936736e+09</td>
      <td>3.912005e+09</td>
      <td>3.473252e+09</td>
      <td>4.388687e+09</td>
      <td>6.221741e+09</td>
      <td>7.087409e+09</td>
      <td>5.035225e+09</td>
      <td>4.960782e+09</td>
      <td>4.799346e+09</td>
      <td>2.262591e+09</td>
      <td>2.778995e+09</td>
      <td>4.723886e+09</td>
      <td>4.334889e+09</td>
      <td>1.247480e+09</td>
      <td>1.892225e+09</td>
      <td>1.962624e+09</td>
      <td>1.284465e+09</td>
      <td>9.996783e+08</td>
      <td>...</td>
      <td>1.383741e+03</td>
      <td>1.383737e+03</td>
      <td>1.383732e+03</td>
      <td>1.383728e+03</td>
      <td>1.383724e+03</td>
      <td>1.383720e+03</td>
      <td>1.383716e+03</td>
      <td>1.383712e+03</td>
      <td>1.383708e+03</td>
      <td>1.383705e+03</td>
      <td>1.383701e+03</td>
      <td>1.383698e+03</td>
      <td>1.383695e+03</td>
      <td>1.383692e+03</td>
      <td>1.383689e+03</td>
      <td>1.383686e+03</td>
      <td>1.383683e+03</td>
      <td>1.383681e+03</td>
      <td>1.383678e+03</td>
      <td>1.383676e+03</td>
      <td>1.383674e+03</td>
      <td>1.383671e+03</td>
      <td>1.383670e+03</td>
      <td>1.383668e+03</td>
      <td>1.383666e+03</td>
      <td>1.383664e+03</td>
      <td>1.383663e+03</td>
      <td>1.383661e+03</td>
      <td>1.383660e+03</td>
      <td>1.383659e+03</td>
      <td>1.383658e+03</td>
      <td>1.383657e+03</td>
      <td>1.383656e+03</td>
      <td>1.383656e+03</td>
      <td>1.383655e+03</td>
      <td>1.383655e+03</td>
      <td>1.383654e+03</td>
      <td>1.383654e+03</td>
      <td>6.918270e+02</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92</th>
      <td>3.003987e-22</td>
      <td>2.193934e+10</td>
      <td>3.476167e+10</td>
      <td>5.756229e+09</td>
      <td>3.338234e+09</td>
      <td>1.596978e+09</td>
      <td>3.901232e+09</td>
      <td>3.096381e+09</td>
      <td>1.385702e+08</td>
      <td>2.057867e+08</td>
      <td>1.498203e+09</td>
      <td>2.778013e+08</td>
      <td>1.972097e+09</td>
      <td>1.002296e+08</td>
      <td>4.203961e+08</td>
      <td>5.003830e+08</td>
      <td>9.213325e+08</td>
      <td>3.639927e+07</td>
      <td>1.532101e+08</td>
      <td>7.530989e+08</td>
      <td>5.727591e+07</td>
      <td>3.229936e+08</td>
      <td>1.240524e+08</td>
      <td>1.682591e+08</td>
      <td>4.352538e+08</td>
      <td>1.146596e+08</td>
      <td>2.886079e+07</td>
      <td>1.750333e+07</td>
      <td>2.888187e+07</td>
      <td>1.230348e+08</td>
      <td>5.430957e+06</td>
      <td>1.471160e+08</td>
      <td>1.814644e+08</td>
      <td>1.891106e+07</td>
      <td>1.950586e+08</td>
      <td>1.176811e+08</td>
      <td>3.555871e+07</td>
      <td>9.392426e+07</td>
      <td>7.405261e+09</td>
      <td>2.248148e+08</td>
      <td>...</td>
      <td>6.895641e+00</td>
      <td>6.895618e+00</td>
      <td>6.895596e+00</td>
      <td>6.895575e+00</td>
      <td>6.895554e+00</td>
      <td>6.895534e+00</td>
      <td>6.895515e+00</td>
      <td>6.895496e+00</td>
      <td>6.895477e+00</td>
      <td>6.895460e+00</td>
      <td>6.895443e+00</td>
      <td>6.895426e+00</td>
      <td>6.895410e+00</td>
      <td>6.895395e+00</td>
      <td>6.895380e+00</td>
      <td>6.895366e+00</td>
      <td>6.895352e+00</td>
      <td>6.895340e+00</td>
      <td>6.895327e+00</td>
      <td>6.895315e+00</td>
      <td>6.895304e+00</td>
      <td>6.895294e+00</td>
      <td>6.895284e+00</td>
      <td>6.895275e+00</td>
      <td>6.895266e+00</td>
      <td>6.895258e+00</td>
      <td>6.895250e+00</td>
      <td>6.895243e+00</td>
      <td>6.895237e+00</td>
      <td>6.895231e+00</td>
      <td>6.895226e+00</td>
      <td>6.895222e+00</td>
      <td>6.895218e+00</td>
      <td>6.895215e+00</td>
      <td>6.895212e+00</td>
      <td>6.895210e+00</td>
      <td>6.895208e+00</td>
      <td>6.895207e+00</td>
      <td>3.447603e+00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>112</th>
      <td>6.085895e-23</td>
      <td>2.508199e+10</td>
      <td>2.671433e+10</td>
      <td>3.458125e+10</td>
      <td>2.183046e+09</td>
      <td>2.913235e+10</td>
      <td>1.529532e+10</td>
      <td>2.041126e+10</td>
      <td>9.492592e+09</td>
      <td>4.173585e+09</td>
      <td>8.286883e+09</td>
      <td>3.807406e+09</td>
      <td>1.621156e+09</td>
      <td>3.544895e+09</td>
      <td>1.688447e+09</td>
      <td>2.456768e+09</td>
      <td>9.215532e+08</td>
      <td>3.701348e+09</td>
      <td>7.629576e+08</td>
      <td>8.599160e+08</td>
      <td>9.432845e+07</td>
      <td>2.130174e+09</td>
      <td>8.154774e+08</td>
      <td>1.670346e+09</td>
      <td>4.049332e+08</td>
      <td>2.506906e+08</td>
      <td>1.076488e+09</td>
      <td>7.620423e+07</td>
      <td>3.262416e+08</td>
      <td>4.253027e+08</td>
      <td>1.258279e+08</td>
      <td>4.688591e+08</td>
      <td>1.020505e+09</td>
      <td>2.253089e+07</td>
      <td>1.977092e+08</td>
      <td>1.187127e+09</td>
      <td>1.304308e+08</td>
      <td>7.328006e+08</td>
      <td>1.594333e+09</td>
      <td>3.496810e+08</td>
      <td>...</td>
      <td>1.450557e+03</td>
      <td>1.450552e+03</td>
      <td>1.450547e+03</td>
      <td>1.450543e+03</td>
      <td>1.450538e+03</td>
      <td>1.450534e+03</td>
      <td>1.450530e+03</td>
      <td>1.450526e+03</td>
      <td>1.450522e+03</td>
      <td>1.450519e+03</td>
      <td>1.450515e+03</td>
      <td>1.450511e+03</td>
      <td>1.450508e+03</td>
      <td>1.450505e+03</td>
      <td>1.450502e+03</td>
      <td>1.450499e+03</td>
      <td>1.450496e+03</td>
      <td>1.450493e+03</td>
      <td>1.450491e+03</td>
      <td>1.450488e+03</td>
      <td>1.450486e+03</td>
      <td>1.450484e+03</td>
      <td>1.450482e+03</td>
      <td>1.450480e+03</td>
      <td>1.450478e+03</td>
      <td>1.450476e+03</td>
      <td>1.450474e+03</td>
      <td>1.450473e+03</td>
      <td>1.450472e+03</td>
      <td>1.450470e+03</td>
      <td>1.450469e+03</td>
      <td>1.450468e+03</td>
      <td>1.450468e+03</td>
      <td>1.450467e+03</td>
      <td>1.450466e+03</td>
      <td>1.450466e+03</td>
      <td>1.450466e+03</td>
      <td>1.450465e+03</td>
      <td>7.252327e+02</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>7.520660e-23</td>
      <td>6.582516e+10</td>
      <td>1.176575e+09</td>
      <td>5.726639e+10</td>
      <td>5.566852e+09</td>
      <td>2.512593e+10</td>
      <td>6.645201e+09</td>
      <td>2.633803e+09</td>
      <td>2.373441e+09</td>
      <td>2.738804e+09</td>
      <td>1.108361e+10</td>
      <td>1.011122e+09</td>
      <td>1.796283e+10</td>
      <td>4.548535e+09</td>
      <td>4.153863e+09</td>
      <td>5.986967e+09</td>
      <td>7.591259e+08</td>
      <td>4.204495e+09</td>
      <td>2.445218e+09</td>
      <td>2.999276e+09</td>
      <td>2.288641e+08</td>
      <td>5.048715e+09</td>
      <td>3.212317e+09</td>
      <td>1.767702e+08</td>
      <td>3.379057e+09</td>
      <td>5.470107e+08</td>
      <td>1.534445e+06</td>
      <td>8.561774e+07</td>
      <td>2.678881e+08</td>
      <td>5.831388e+08</td>
      <td>2.250089e+09</td>
      <td>2.945777e+09</td>
      <td>2.354936e+09</td>
      <td>4.394168e+08</td>
      <td>5.295828e+08</td>
      <td>1.999850e+09</td>
      <td>3.491288e+08</td>
      <td>9.152734e+07</td>
      <td>6.722281e+08</td>
      <td>2.420303e+09</td>
      <td>...</td>
      <td>1.157560e+07</td>
      <td>4.970938e+06</td>
      <td>1.044088e+07</td>
      <td>2.076864e+07</td>
      <td>5.652504e+06</td>
      <td>3.240631e+06</td>
      <td>1.397898e+07</td>
      <td>1.008912e+06</td>
      <td>2.327728e+07</td>
      <td>2.909226e+07</td>
      <td>3.869044e+06</td>
      <td>3.251341e+06</td>
      <td>2.399123e+07</td>
      <td>5.366716e+07</td>
      <td>1.863748e+07</td>
      <td>4.281250e+06</td>
      <td>1.950633e+07</td>
      <td>3.989715e+07</td>
      <td>3.906992e+07</td>
      <td>1.556306e+07</td>
      <td>1.263990e+07</td>
      <td>2.418054e+07</td>
      <td>1.361411e+07</td>
      <td>8.309645e+06</td>
      <td>2.176511e+07</td>
      <td>8.594606e+06</td>
      <td>5.784685e+04</td>
      <td>8.229419e+04</td>
      <td>2.710502e+07</td>
      <td>4.228367e+07</td>
      <td>1.220436e+07</td>
      <td>1.449948e+06</td>
      <td>1.991303e+07</td>
      <td>1.383334e+06</td>
      <td>3.488514e+06</td>
      <td>2.693400e+07</td>
      <td>6.823640e+06</td>
      <td>5.278711e+06</td>
      <td>4.999322e+06</td>
      <td>0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2.005767e-23</td>
      <td>2.483386e+11</td>
      <td>3.034385e+11</td>
      <td>5.397407e+09</td>
      <td>9.714590e+10</td>
      <td>3.074372e+09</td>
      <td>4.607364e+10</td>
      <td>6.113658e+09</td>
      <td>2.487312e+10</td>
      <td>3.281864e+09</td>
      <td>3.171297e+09</td>
      <td>4.322904e+08</td>
      <td>7.593255e+08</td>
      <td>5.041733e+09</td>
      <td>2.014204e+10</td>
      <td>8.716218e+07</td>
      <td>1.438071e+10</td>
      <td>2.324841e+09</td>
      <td>5.329362e+09</td>
      <td>2.122016e+09</td>
      <td>2.336579e+08</td>
      <td>3.276469e+08</td>
      <td>3.614434e+08</td>
      <td>4.081245e+09</td>
      <td>2.247445e+09</td>
      <td>5.308821e+08</td>
      <td>7.717831e+09</td>
      <td>7.687563e+08</td>
      <td>3.279740e+09</td>
      <td>2.631919e+08</td>
      <td>6.609370e+09</td>
      <td>2.438674e+09</td>
      <td>1.032339e+09</td>
      <td>6.609401e+09</td>
      <td>2.769244e+09</td>
      <td>2.386537e+09</td>
      <td>2.067472e+10</td>
      <td>2.984367e+10</td>
      <td>7.234662e+10</td>
      <td>5.054561e+10</td>
      <td>...</td>
      <td>3.646149e+06</td>
      <td>3.104552e+06</td>
      <td>6.063856e+07</td>
      <td>7.379961e+06</td>
      <td>4.232041e+06</td>
      <td>8.361054e+06</td>
      <td>1.008574e+07</td>
      <td>2.675340e+07</td>
      <td>2.353878e+06</td>
      <td>3.933722e+07</td>
      <td>1.294616e+07</td>
      <td>6.858054e+07</td>
      <td>1.564118e+07</td>
      <td>1.564992e+07</td>
      <td>1.929105e+07</td>
      <td>1.895119e+07</td>
      <td>2.445280e+06</td>
      <td>1.220851e+07</td>
      <td>1.957260e+07</td>
      <td>3.177603e+07</td>
      <td>9.153447e+06</td>
      <td>3.882828e+07</td>
      <td>6.555127e+07</td>
      <td>3.676038e+06</td>
      <td>5.286998e+07</td>
      <td>2.373915e+07</td>
      <td>3.191280e+06</td>
      <td>1.308186e+08</td>
      <td>1.445847e+07</td>
      <td>2.031333e+07</td>
      <td>2.910264e+07</td>
      <td>3.628487e+07</td>
      <td>8.872919e+07</td>
      <td>1.077391e+07</td>
      <td>5.264475e+06</td>
      <td>2.564387e+07</td>
      <td>1.219609e+07</td>
      <td>2.248579e+06</td>
      <td>4.098014e+06</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7527 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="c1"># Matrix of features (Independent variable), X: numpy.ndarray</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Dependent variable vector, y: numpy.ndarray</span>
</pre></div>
</div>
</div>
<div class="section" id="Preprocessing">
<h3>Preprocessing<a class="headerlink" href="#Preprocessing" title="Permalink to this headline">¶</a></h3>
<p><strong>1. Normalization</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="n">normalized_data</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>2. PCA - Dimensionality Reduction</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="c1"># What is the minimun value of `n_components` to keep 95% of variance on data ?</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">cumsum</span> <span class="o">&gt;=</span> <span class="mf">0.95</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The minimun value is:&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The minimun value is: 49
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Best altenative… set the <code class="docutils literal notranslate"><span class="pre">n_components</span></code> to fluctuate between 0.0 and 1.0, indicating the rate of variance you want to preserve</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id8">
<h3>Splitting the dataset into the Training set and Test set<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_reduced</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(98, 49) (98,) (33, 49) (33,)
</pre></div></div>
</div>
</div>
<div class="section" id="Train-model">
<h3>Train model<a class="headerlink" href="#Train-model" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="n">class_trees</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">class_trees</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion=&#39;gini&#39;,
                       max_depth=None, max_features=None, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort=&#39;deprecated&#39;,
                       random_state=42, splitter=&#39;best&#39;)
</pre></div></div>
</div>
<div class="section" id="Results">
<h4>Results<a class="headerlink" href="#Results" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">plot_confusion_matrix</span>

<span class="n">labels_formated</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;confirmed exoplanets&#39;</span><span class="p">,</span> <span class="s1">&#39;eclipsing binaries&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">class_trees</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span>
                             <span class="n">display_labels</span><span class="o">=</span><span class="n">labels_formated</span><span class="p">,</span>
                             <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span>
                             <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Decision Trees Classifier - Confusion matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_-_Machine_Learning_77_0.png" src="_images/06_-_Machine_Learning_77_0.png" />
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="XGBoost---0.585">
<h1>XGBoost - 0.585<a class="headerlink" href="#XGBoost---0.585" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p><a class="reference external" href="https://xgboost.readthedocs.io/en/latest/parameter.html">https://xgboost.readthedocs.io/en/latest/parameter.html</a></p>
<div class="section" id="id9">
<h2>Feature: Periodograms<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">FEATURES_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/features&#39;</span>
<span class="n">PERIODOGRAMS_DIR</span> <span class="o">=</span> <span class="n">FEATURES_DIR</span> <span class="o">+</span> <span class="s1">&#39;/feature_periodograms.csv&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">PERIODOGRAMS_DIR</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>7487</th>
      <th>7488</th>
      <th>7489</th>
      <th>7490</th>
      <th>7491</th>
      <th>7492</th>
      <th>7493</th>
      <th>7494</th>
      <th>7495</th>
      <th>7496</th>
      <th>7497</th>
      <th>7498</th>
      <th>7499</th>
      <th>7500</th>
      <th>7501</th>
      <th>7502</th>
      <th>7503</th>
      <th>7504</th>
      <th>7505</th>
      <th>7506</th>
      <th>7507</th>
      <th>7508</th>
      <th>7509</th>
      <th>7510</th>
      <th>7511</th>
      <th>7512</th>
      <th>7513</th>
      <th>7514</th>
      <th>7515</th>
      <th>7516</th>
      <th>7517</th>
      <th>7518</th>
      <th>7519</th>
      <th>7520</th>
      <th>7521</th>
      <th>7522</th>
      <th>7523</th>
      <th>7524</th>
      <th>7525</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>97</th>
      <td>6.567484e-24</td>
      <td>1.178041e+10</td>
      <td>5.298207e+09</td>
      <td>9.132480e+09</td>
      <td>1.002822e+10</td>
      <td>3.540825e+09</td>
      <td>4.228655e+09</td>
      <td>4.095593e+09</td>
      <td>2.244863e+08</td>
      <td>1.012111e+09</td>
      <td>2.164379e+09</td>
      <td>1.789251e+09</td>
      <td>1.365437e+09</td>
      <td>1.876186e+09</td>
      <td>2.027531e+09</td>
      <td>7.245684e+12</td>
      <td>1.720589e+09</td>
      <td>7.179984e+08</td>
      <td>1.050979e+09</td>
      <td>9.693505e+08</td>
      <td>1.354755e+09</td>
      <td>1.007977e+09</td>
      <td>3.747895e+08</td>
      <td>2.814626e+08</td>
      <td>4.937656e+08</td>
      <td>2.295634e+09</td>
      <td>3.026242e+09</td>
      <td>3.029127e+09</td>
      <td>1.860285e+09</td>
      <td>2.587133e+09</td>
      <td>1.779195e+13</td>
      <td>8.697306e+08</td>
      <td>1.296085e+09</td>
      <td>1.402465e+08</td>
      <td>1.454082e+09</td>
      <td>4.639711e+08</td>
      <td>1.589614e+08</td>
      <td>1.291053e+09</td>
      <td>1.517971e+08</td>
      <td>7.411420e+08</td>
      <td>...</td>
      <td>1.076525e+03</td>
      <td>1.076522e+03</td>
      <td>1.076519e+03</td>
      <td>1.076515e+03</td>
      <td>1.076512e+03</td>
      <td>1.076509e+03</td>
      <td>1.076506e+03</td>
      <td>1.076503e+03</td>
      <td>1.076500e+03</td>
      <td>1.076497e+03</td>
      <td>1.076495e+03</td>
      <td>1.076492e+03</td>
      <td>1.076489e+03</td>
      <td>1.076487e+03</td>
      <td>1.076485e+03</td>
      <td>1.076483e+03</td>
      <td>1.076480e+03</td>
      <td>1.076478e+03</td>
      <td>1076.476488</td>
      <td>1.076475e+03</td>
      <td>1.076473e+03</td>
      <td>1.076471e+03</td>
      <td>1076.469734</td>
      <td>1.076468e+03</td>
      <td>1.076467e+03</td>
      <td>1.076466e+03</td>
      <td>1.076464e+03</td>
      <td>1.076463e+03</td>
      <td>1.076462e+03</td>
      <td>1.076462e+03</td>
      <td>1.076461e+03</td>
      <td>1.076460e+03</td>
      <td>1.076459e+03</td>
      <td>1076.458898</td>
      <td>1.076458e+03</td>
      <td>1.076458e+03</td>
      <td>1.076458e+03</td>
      <td>1.076458e+03</td>
      <td>5.382289e+02</td>
      <td>1</td>
    </tr>
    <tr>
      <th>59</th>
      <td>5.748580e-20</td>
      <td>6.211685e+10</td>
      <td>2.216964e+09</td>
      <td>1.435994e+10</td>
      <td>1.719760e+10</td>
      <td>8.704939e+09</td>
      <td>4.907214e+09</td>
      <td>2.450727e+09</td>
      <td>6.121095e+09</td>
      <td>4.615305e+08</td>
      <td>4.269709e+08</td>
      <td>2.070437e+09</td>
      <td>1.608734e+08</td>
      <td>1.740199e+09</td>
      <td>2.628103e+08</td>
      <td>1.164062e+09</td>
      <td>3.439496e+09</td>
      <td>3.440799e+09</td>
      <td>3.752920e+09</td>
      <td>2.090612e+09</td>
      <td>1.269435e+09</td>
      <td>2.729621e+09</td>
      <td>3.853905e+09</td>
      <td>8.723574e+09</td>
      <td>2.646283e+09</td>
      <td>8.650304e+09</td>
      <td>6.046799e+09</td>
      <td>1.536936e+10</td>
      <td>1.372588e+10</td>
      <td>3.027827e+10</td>
      <td>2.291537e+10</td>
      <td>1.746399e+10</td>
      <td>2.597201e+11</td>
      <td>6.334982e+12</td>
      <td>1.774388e+12</td>
      <td>2.501299e+11</td>
      <td>4.467781e+10</td>
      <td>8.605329e+10</td>
      <td>3.695356e+10</td>
      <td>3.505263e+10</td>
      <td>...</td>
      <td>2.414816e+04</td>
      <td>2.414808e+04</td>
      <td>2.414800e+04</td>
      <td>2.414793e+04</td>
      <td>2.414785e+04</td>
      <td>2.414778e+04</td>
      <td>2.414772e+04</td>
      <td>2.414765e+04</td>
      <td>2.414759e+04</td>
      <td>2.414752e+04</td>
      <td>2.414746e+04</td>
      <td>2.414741e+04</td>
      <td>2.414735e+04</td>
      <td>2.414730e+04</td>
      <td>2.414724e+04</td>
      <td>2.414719e+04</td>
      <td>2.414715e+04</td>
      <td>2.414710e+04</td>
      <td>24147.059038</td>
      <td>2.414702e+04</td>
      <td>2.414698e+04</td>
      <td>2.414694e+04</td>
      <td>24146.907523</td>
      <td>2.414687e+04</td>
      <td>2.414684e+04</td>
      <td>2.414682e+04</td>
      <td>2.414679e+04</td>
      <td>2.414677e+04</td>
      <td>2.414674e+04</td>
      <td>2.414672e+04</td>
      <td>2.414671e+04</td>
      <td>2.414669e+04</td>
      <td>2.414668e+04</td>
      <td>24146.664472</td>
      <td>2.414666e+04</td>
      <td>2.414665e+04</td>
      <td>2.414664e+04</td>
      <td>2.414664e+04</td>
      <td>1.207332e+04</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1.752484e-21</td>
      <td>9.756491e+10</td>
      <td>3.995481e+10</td>
      <td>1.105439e+10</td>
      <td>3.336733e+09</td>
      <td>3.161758e+09</td>
      <td>3.782595e+09</td>
      <td>5.017278e+09</td>
      <td>1.508046e+09</td>
      <td>1.459446e+09</td>
      <td>5.922758e+08</td>
      <td>4.391054e+08</td>
      <td>1.723186e+09</td>
      <td>1.404142e+09</td>
      <td>9.070158e+08</td>
      <td>4.035657e+08</td>
      <td>8.472543e+08</td>
      <td>2.859164e+08</td>
      <td>2.233725e+08</td>
      <td>4.385475e+08</td>
      <td>2.653935e+07</td>
      <td>1.300230e+09</td>
      <td>1.120066e+09</td>
      <td>1.688150e+08</td>
      <td>1.741311e+07</td>
      <td>5.441521e+08</td>
      <td>2.447330e+07</td>
      <td>6.426762e+07</td>
      <td>2.427007e+08</td>
      <td>6.739195e+07</td>
      <td>6.132567e+08</td>
      <td>1.442627e+08</td>
      <td>9.345792e+07</td>
      <td>1.235102e+08</td>
      <td>4.746666e+08</td>
      <td>1.192272e+08</td>
      <td>2.053329e+08</td>
      <td>2.421255e+08</td>
      <td>9.038041e+07</td>
      <td>4.684413e+07</td>
      <td>...</td>
      <td>5.069784e+06</td>
      <td>1.481839e+06</td>
      <td>6.506158e+06</td>
      <td>4.203149e+06</td>
      <td>1.004154e+07</td>
      <td>7.254977e+06</td>
      <td>1.675987e+07</td>
      <td>1.362856e+07</td>
      <td>3.276551e+06</td>
      <td>3.198822e+07</td>
      <td>3.470285e+06</td>
      <td>2.147650e+07</td>
      <td>1.048925e+07</td>
      <td>2.111648e+06</td>
      <td>7.221949e+06</td>
      <td>1.317321e+07</td>
      <td>2.028878e+07</td>
      <td>2.733158e+06</td>
      <td>373819.128620</td>
      <td>1.328582e+07</td>
      <td>9.991568e+06</td>
      <td>4.730944e+06</td>
      <td>474384.659373</td>
      <td>5.020889e+06</td>
      <td>9.238025e+06</td>
      <td>2.269643e+07</td>
      <td>2.639189e+07</td>
      <td>1.203043e+07</td>
      <td>6.267373e+06</td>
      <td>4.170246e+06</td>
      <td>4.640980e+06</td>
      <td>6.198973e+06</td>
      <td>1.228420e+07</td>
      <td>223599.331136</td>
      <td>4.635344e+06</td>
      <td>2.317602e+07</td>
      <td>4.720558e+06</td>
      <td>1.783050e+07</td>
      <td>7.135303e+07</td>
      <td>0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>4.444052e-21</td>
      <td>1.225255e+11</td>
      <td>8.684239e+11</td>
      <td>3.046022e+11</td>
      <td>3.763060e+11</td>
      <td>3.998026e+10</td>
      <td>2.059423e+07</td>
      <td>1.908615e+09</td>
      <td>1.245052e+10</td>
      <td>1.664964e+10</td>
      <td>1.750149e+09</td>
      <td>1.974743e+09</td>
      <td>1.564496e+10</td>
      <td>9.473577e+09</td>
      <td>4.174117e+09</td>
      <td>3.589926e+08</td>
      <td>3.528037e+08</td>
      <td>4.494764e+08</td>
      <td>1.807520e+09</td>
      <td>1.496267e+09</td>
      <td>9.872100e+07</td>
      <td>1.281638e+09</td>
      <td>9.822630e+07</td>
      <td>2.448930e+09</td>
      <td>1.786816e+07</td>
      <td>8.014748e+08</td>
      <td>9.356294e+08</td>
      <td>8.695086e+08</td>
      <td>1.502131e+09</td>
      <td>8.623401e+08</td>
      <td>2.380475e+09</td>
      <td>6.490083e+08</td>
      <td>1.295033e+09</td>
      <td>5.574792e+08</td>
      <td>7.684658e+08</td>
      <td>2.706459e+09</td>
      <td>1.572336e+08</td>
      <td>8.620298e+08</td>
      <td>2.541334e+08</td>
      <td>5.012295e+07</td>
      <td>...</td>
      <td>3.042985e+04</td>
      <td>3.042975e+04</td>
      <td>3.042965e+04</td>
      <td>3.042956e+04</td>
      <td>3.042947e+04</td>
      <td>3.042938e+04</td>
      <td>3.042929e+04</td>
      <td>3.042921e+04</td>
      <td>3.042913e+04</td>
      <td>3.042905e+04</td>
      <td>3.042897e+04</td>
      <td>3.042890e+04</td>
      <td>3.042883e+04</td>
      <td>3.042876e+04</td>
      <td>3.042870e+04</td>
      <td>3.042864e+04</td>
      <td>3.042858e+04</td>
      <td>3.042852e+04</td>
      <td>30428.464346</td>
      <td>3.042841e+04</td>
      <td>3.042836e+04</td>
      <td>3.042832e+04</td>
      <td>30428.273418</td>
      <td>3.042823e+04</td>
      <td>3.042819e+04</td>
      <td>3.042816e+04</td>
      <td>3.042812e+04</td>
      <td>3.042809e+04</td>
      <td>3.042807e+04</td>
      <td>3.042804e+04</td>
      <td>3.042802e+04</td>
      <td>3.042800e+04</td>
      <td>3.042798e+04</td>
      <td>30427.967140</td>
      <td>3.042796e+04</td>
      <td>3.042795e+04</td>
      <td>3.042794e+04</td>
      <td>3.042794e+04</td>
      <td>1.521397e+04</td>
      <td>1</td>
    </tr>
    <tr>
      <th>32</th>
      <td>4.534147e-21</td>
      <td>4.810687e+11</td>
      <td>7.156296e+11</td>
      <td>7.907086e+10</td>
      <td>1.827524e+11</td>
      <td>3.066684e+10</td>
      <td>2.281262e+10</td>
      <td>2.472757e+10</td>
      <td>2.943501e+10</td>
      <td>3.255523e+10</td>
      <td>3.103233e+10</td>
      <td>2.130254e+10</td>
      <td>3.009069e+10</td>
      <td>7.761600e+09</td>
      <td>1.505235e+10</td>
      <td>6.974905e+09</td>
      <td>1.466913e+10</td>
      <td>5.582512e+08</td>
      <td>1.547837e+10</td>
      <td>8.222439e+09</td>
      <td>8.399665e+08</td>
      <td>1.454228e+09</td>
      <td>3.245127e+09</td>
      <td>4.154653e+09</td>
      <td>1.935284e+09</td>
      <td>5.700948e+09</td>
      <td>3.176125e+09</td>
      <td>3.062322e+09</td>
      <td>3.942368e+08</td>
      <td>1.405007e+09</td>
      <td>5.606020e+08</td>
      <td>8.074106e+08</td>
      <td>8.842706e+08</td>
      <td>1.022849e+08</td>
      <td>2.209409e+09</td>
      <td>3.976962e+09</td>
      <td>3.228091e+08</td>
      <td>1.296049e+09</td>
      <td>1.387544e+09</td>
      <td>3.794390e+08</td>
      <td>...</td>
      <td>2.085999e+05</td>
      <td>2.085992e+05</td>
      <td>2.085985e+05</td>
      <td>2.085979e+05</td>
      <td>2.085973e+05</td>
      <td>2.085966e+05</td>
      <td>2.085961e+05</td>
      <td>2.085955e+05</td>
      <td>2.085949e+05</td>
      <td>2.085944e+05</td>
      <td>2.085939e+05</td>
      <td>2.085934e+05</td>
      <td>2.085929e+05</td>
      <td>2.085924e+05</td>
      <td>2.085920e+05</td>
      <td>2.085916e+05</td>
      <td>2.085911e+05</td>
      <td>2.085908e+05</td>
      <td>208590.383540</td>
      <td>2.085900e+05</td>
      <td>2.085897e+05</td>
      <td>2.085894e+05</td>
      <td>208589.074708</td>
      <td>2.085888e+05</td>
      <td>2.085885e+05</td>
      <td>2.085883e+05</td>
      <td>2.085881e+05</td>
      <td>2.085878e+05</td>
      <td>2.085877e+05</td>
      <td>2.085875e+05</td>
      <td>2.085873e+05</td>
      <td>2.085872e+05</td>
      <td>2.085871e+05</td>
      <td>208586.975144</td>
      <td>2.085869e+05</td>
      <td>2.085868e+05</td>
      <td>2.085868e+05</td>
      <td>2.085868e+05</td>
      <td>1.042934e+05</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7527 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="c1"># Matrix of features (Independent variable), X: numpy.ndarray</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Dependent variable vector, y: numpy.ndarray</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3>Preprocessing<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p><strong>1. Normalization</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="n">normalized_data</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>2. PCA - Dimensionality Reduction</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="c1"># What is the minimun value of `n_components` to keep 95% of variance on data ?</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">cumsum</span> <span class="o">&gt;=</span> <span class="mf">0.95</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The minimun value is:&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The minimun value is: 49
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Best altenative… set the <code class="docutils literal notranslate"><span class="pre">n_components</span></code> to fluctuate between 0.0 and 1.0, indicating the rate of variance you want to preserve</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id11">
<h3>Splitting the dataset into the Training set and Test set<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_reduced</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(98, 49) (98,) (33, 49) (33,)
</pre></div></div>
</div>
</div>
<div class="section" id="id12">
<h3>Train model<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>

<span class="n">class_xgb</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">class_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
XGBClassifier(base_score=0.5, booster=&#39;gbtree&#39;, colsample_bylevel=1,
              colsample_bynode=1, colsample_bytree=1, gamma=0,
              learning_rate=0.3, max_delta_step=0, max_depth=6,
              min_child_weight=1, missing=None, n_estimators=100, n_jobs=1,
              nthread=None, objective=&#39;binary:logistic&#39;, random_state=42,
              reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,
              silent=None, subsample=1, verbosity=0)
</pre></div></div>
</div>
<div class="section" id="id13">
<h4>Results<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">plot_confusion_matrix</span>

<span class="n">labels_formated</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;confirmed exoplanets&#39;</span><span class="p">,</span> <span class="s1">&#39;eclipsing binaries&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">class_xgb</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span>
                             <span class="n">display_labels</span><span class="o">=</span><span class="n">labels_formated</span><span class="p">,</span>
                             <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span>
                             <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;XGBoost Classifier - Confusion matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_-_Machine_Learning_95_0.png" src="_images/06_-_Machine_Learning_95_0.png" />
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="Gaussian-Mixture-Models">
<h1>Gaussian Mixture Models<a class="headerlink" href="#Gaussian-Mixture-Models" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.mixture.GaussianMixture.html">https://scikit-learn.org/stable/modules/generated/sklearn.mixture.GaussianMixture.html</a></p>
<div class="section" id="id14">
<h2>Feature: Periodograms<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">FEATURES_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/features&#39;</span>
<span class="n">PERIODOGRAMS_DIR</span> <span class="o">=</span> <span class="n">FEATURES_DIR</span> <span class="o">+</span> <span class="s1">&#39;/feature_periodograms.csv&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">PERIODOGRAMS_DIR</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>7487</th>
      <th>7488</th>
      <th>7489</th>
      <th>7490</th>
      <th>7491</th>
      <th>7492</th>
      <th>7493</th>
      <th>7494</th>
      <th>7495</th>
      <th>7496</th>
      <th>7497</th>
      <th>7498</th>
      <th>7499</th>
      <th>7500</th>
      <th>7501</th>
      <th>7502</th>
      <th>7503</th>
      <th>7504</th>
      <th>7505</th>
      <th>7506</th>
      <th>7507</th>
      <th>7508</th>
      <th>7509</th>
      <th>7510</th>
      <th>7511</th>
      <th>7512</th>
      <th>7513</th>
      <th>7514</th>
      <th>7515</th>
      <th>7516</th>
      <th>7517</th>
      <th>7518</th>
      <th>7519</th>
      <th>7520</th>
      <th>7521</th>
      <th>7522</th>
      <th>7523</th>
      <th>7524</th>
      <th>7525</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>121</th>
      <td>3.099730e-21</td>
      <td>1.450455e+11</td>
      <td>5.851971e+10</td>
      <td>1.371264e+10</td>
      <td>6.332105e+10</td>
      <td>7.659462e+10</td>
      <td>2.038631e+10</td>
      <td>1.701385e+10</td>
      <td>3.411757e+10</td>
      <td>1.877369e+10</td>
      <td>8.258293e+10</td>
      <td>4.761234e+09</td>
      <td>1.889632e+10</td>
      <td>4.737847e+10</td>
      <td>6.443619e+10</td>
      <td>2.390949e+10</td>
      <td>3.833547e+10</td>
      <td>4.000678e+10</td>
      <td>1.699051e+10</td>
      <td>1.877011e+10</td>
      <td>2.347108e+10</td>
      <td>1.919521e+10</td>
      <td>1.872913e+10</td>
      <td>5.364253e+10</td>
      <td>9.076523e+09</td>
      <td>4.618874e+10</td>
      <td>2.637520e+10</td>
      <td>1.318005e+10</td>
      <td>3.798276e+10</td>
      <td>2.442435e+10</td>
      <td>4.000654e+10</td>
      <td>4.623934e+10</td>
      <td>3.615225e+10</td>
      <td>2.993127e+10</td>
      <td>3.303417e+10</td>
      <td>3.022440e+10</td>
      <td>2.011551e+10</td>
      <td>3.900373e+10</td>
      <td>4.138960e+10</td>
      <td>2.368466e+10</td>
      <td>...</td>
      <td>9970.968395</td>
      <td>9970.935809</td>
      <td>9970.904092</td>
      <td>9970.873244</td>
      <td>9970.843265</td>
      <td>9970.814155</td>
      <td>9970.785914</td>
      <td>9970.758543</td>
      <td>9970.732040</td>
      <td>9970.706406</td>
      <td>9970.681642</td>
      <td>9970.657746</td>
      <td>9970.634719</td>
      <td>9970.612562</td>
      <td>9970.591273</td>
      <td>9970.570853</td>
      <td>9970.551303</td>
      <td>9970.532621</td>
      <td>9970.514808</td>
      <td>9970.497864</td>
      <td>9970.481790</td>
      <td>9970.466584</td>
      <td>9970.452247</td>
      <td>9970.438779</td>
      <td>9970.426180</td>
      <td>9970.414449</td>
      <td>9970.403588</td>
      <td>9970.393596</td>
      <td>9970.384472</td>
      <td>9970.376218</td>
      <td>9970.368832</td>
      <td>9970.362315</td>
      <td>9970.356668</td>
      <td>9970.351889</td>
      <td>9970.347979</td>
      <td>9970.344938</td>
      <td>9970.342765</td>
      <td>9970.341462</td>
      <td>4985.170514</td>
      <td>1</td>
    </tr>
    <tr>
      <th>104</th>
      <td>2.544691e-21</td>
      <td>9.069646e+10</td>
      <td>6.643117e+10</td>
      <td>5.117582e+10</td>
      <td>3.413736e+10</td>
      <td>4.787929e+10</td>
      <td>1.866267e+10</td>
      <td>1.943006e+10</td>
      <td>2.532991e+09</td>
      <td>9.193865e+09</td>
      <td>2.942133e+08</td>
      <td>7.123645e+09</td>
      <td>1.065354e+10</td>
      <td>2.174687e+10</td>
      <td>2.695494e+11</td>
      <td>2.432953e+11</td>
      <td>1.574357e+10</td>
      <td>3.968706e+09</td>
      <td>2.984037e+09</td>
      <td>4.355211e+09</td>
      <td>4.921942e+09</td>
      <td>6.969427e+09</td>
      <td>9.030065e+09</td>
      <td>6.355329e+09</td>
      <td>9.656856e+09</td>
      <td>4.718208e+09</td>
      <td>3.562666e+09</td>
      <td>1.698194e+09</td>
      <td>8.258263e+09</td>
      <td>7.824319e+11</td>
      <td>8.895930e+08</td>
      <td>1.499607e+09</td>
      <td>1.739245e+10</td>
      <td>2.566922e+09</td>
      <td>9.158103e+09</td>
      <td>6.630252e+10</td>
      <td>1.937514e+10</td>
      <td>1.056860e+11</td>
      <td>1.433715e+10</td>
      <td>1.082412e+10</td>
      <td>...</td>
      <td>2453.104169</td>
      <td>2453.096152</td>
      <td>2453.088348</td>
      <td>2453.080759</td>
      <td>2453.073384</td>
      <td>2453.066222</td>
      <td>2453.059274</td>
      <td>2453.052540</td>
      <td>2453.046019</td>
      <td>2453.039713</td>
      <td>2453.033620</td>
      <td>2453.027741</td>
      <td>2453.022076</td>
      <td>2453.016625</td>
      <td>2453.011387</td>
      <td>2453.006364</td>
      <td>2453.001554</td>
      <td>2452.996957</td>
      <td>2452.992575</td>
      <td>2452.988406</td>
      <td>2452.984452</td>
      <td>2452.980711</td>
      <td>2452.977183</td>
      <td>2452.973870</td>
      <td>2452.970770</td>
      <td>2452.967884</td>
      <td>2452.965212</td>
      <td>2452.962754</td>
      <td>2452.960509</td>
      <td>2452.958478</td>
      <td>2452.956661</td>
      <td>2452.955058</td>
      <td>2452.953669</td>
      <td>2452.952493</td>
      <td>2452.951531</td>
      <td>2452.950783</td>
      <td>2452.950248</td>
      <td>2452.949928</td>
      <td>1226.474910</td>
      <td>1</td>
    </tr>
    <tr>
      <th>83</th>
      <td>7.221651e-21</td>
      <td>4.505717e+08</td>
      <td>7.566718e+06</td>
      <td>9.076482e+08</td>
      <td>5.055431e+08</td>
      <td>5.201719e+08</td>
      <td>3.460490e+08</td>
      <td>2.954526e+08</td>
      <td>3.242125e+08</td>
      <td>4.557197e+07</td>
      <td>3.167933e+07</td>
      <td>2.440220e+07</td>
      <td>1.403096e+08</td>
      <td>9.453829e+07</td>
      <td>1.654833e+07</td>
      <td>1.208286e+06</td>
      <td>3.350352e+07</td>
      <td>5.316386e+07</td>
      <td>3.449430e+07</td>
      <td>1.229629e+08</td>
      <td>1.553346e+08</td>
      <td>2.783925e+08</td>
      <td>8.946271e+07</td>
      <td>7.675415e+06</td>
      <td>1.505378e+07</td>
      <td>6.678298e+05</td>
      <td>1.965005e+08</td>
      <td>4.079288e+08</td>
      <td>9.018535e+07</td>
      <td>3.032997e+07</td>
      <td>5.564186e+07</td>
      <td>1.726893e+08</td>
      <td>2.075812e+08</td>
      <td>7.274091e+08</td>
      <td>1.861569e+08</td>
      <td>2.016792e+08</td>
      <td>4.417020e+08</td>
      <td>2.089950e+08</td>
      <td>3.106678e+08</td>
      <td>9.919087e+08</td>
      <td>...</td>
      <td>121.901107</td>
      <td>121.900708</td>
      <td>121.900321</td>
      <td>121.899943</td>
      <td>121.899577</td>
      <td>121.899221</td>
      <td>121.898876</td>
      <td>121.898541</td>
      <td>121.898217</td>
      <td>121.897904</td>
      <td>121.897601</td>
      <td>121.897309</td>
      <td>121.897027</td>
      <td>121.896756</td>
      <td>121.896496</td>
      <td>121.896247</td>
      <td>121.896008</td>
      <td>121.895779</td>
      <td>121.895561</td>
      <td>121.895354</td>
      <td>121.895158</td>
      <td>121.894972</td>
      <td>121.894797</td>
      <td>121.894632</td>
      <td>121.894478</td>
      <td>121.894334</td>
      <td>121.894202</td>
      <td>121.894079</td>
      <td>121.893968</td>
      <td>121.893867</td>
      <td>121.893777</td>
      <td>121.893697</td>
      <td>121.893628</td>
      <td>121.893570</td>
      <td>121.893522</td>
      <td>121.893485</td>
      <td>121.893458</td>
      <td>121.893442</td>
      <td>60.946718</td>
      <td>1</td>
    </tr>
    <tr>
      <th>126</th>
      <td>2.472828e-21</td>
      <td>8.480713e+10</td>
      <td>3.326409e+10</td>
      <td>1.004276e+10</td>
      <td>1.105842e+10</td>
      <td>9.378111e+09</td>
      <td>5.750926e+08</td>
      <td>2.931827e+09</td>
      <td>7.503412e+09</td>
      <td>2.734914e+09</td>
      <td>7.226858e+09</td>
      <td>8.336502e+08</td>
      <td>3.357986e+09</td>
      <td>9.016144e+08</td>
      <td>1.089214e+09</td>
      <td>2.594842e+09</td>
      <td>2.696162e+09</td>
      <td>1.423190e+09</td>
      <td>3.079399e+09</td>
      <td>1.936290e+09</td>
      <td>4.090007e+06</td>
      <td>3.107745e+08</td>
      <td>4.000904e+08</td>
      <td>3.199724e+07</td>
      <td>3.106817e+08</td>
      <td>1.349838e+09</td>
      <td>1.368688e+07</td>
      <td>2.230739e+08</td>
      <td>9.444796e+08</td>
      <td>5.780070e+08</td>
      <td>3.091359e+08</td>
      <td>1.091311e+08</td>
      <td>7.396224e+07</td>
      <td>1.655690e+09</td>
      <td>2.581546e+09</td>
      <td>8.553230e+06</td>
      <td>3.868140e+08</td>
      <td>1.264882e+09</td>
      <td>1.846532e+08</td>
      <td>4.150413e+08</td>
      <td>...</td>
      <td>8732.550481</td>
      <td>8732.521943</td>
      <td>8732.494165</td>
      <td>8732.467148</td>
      <td>8732.440893</td>
      <td>8732.415398</td>
      <td>8732.390665</td>
      <td>8732.366693</td>
      <td>8732.343482</td>
      <td>8732.321032</td>
      <td>8732.299343</td>
      <td>8732.278416</td>
      <td>8732.258249</td>
      <td>8732.238843</td>
      <td>8732.220199</td>
      <td>8732.202315</td>
      <td>8732.185193</td>
      <td>8732.168832</td>
      <td>8732.153231</td>
      <td>8732.138392</td>
      <td>8732.124313</td>
      <td>8732.110996</td>
      <td>8732.098440</td>
      <td>8732.086645</td>
      <td>8732.075610</td>
      <td>8732.065337</td>
      <td>8732.055825</td>
      <td>8732.047073</td>
      <td>8732.039083</td>
      <td>8732.031854</td>
      <td>8732.025386</td>
      <td>8732.019678</td>
      <td>8732.014732</td>
      <td>8732.010546</td>
      <td>8732.007122</td>
      <td>8732.004459</td>
      <td>8732.002556</td>
      <td>8732.001415</td>
      <td>4366.000517</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.750600e-22</td>
      <td>7.424050e+09</td>
      <td>1.358892e+09</td>
      <td>3.309422e+08</td>
      <td>5.295420e+08</td>
      <td>2.036254e+09</td>
      <td>8.268143e+08</td>
      <td>1.861110e+09</td>
      <td>9.343690e+07</td>
      <td>1.156138e+08</td>
      <td>2.263122e+07</td>
      <td>2.557775e+08</td>
      <td>4.054398e+07</td>
      <td>3.574917e+08</td>
      <td>1.151586e+08</td>
      <td>1.266685e+08</td>
      <td>2.280232e+08</td>
      <td>1.757015e+08</td>
      <td>6.112853e+07</td>
      <td>4.058141e+06</td>
      <td>3.930772e+07</td>
      <td>2.389294e+08</td>
      <td>1.018442e+07</td>
      <td>2.026846e+08</td>
      <td>8.033815e+07</td>
      <td>5.084299e+07</td>
      <td>2.686861e+08</td>
      <td>2.468639e+07</td>
      <td>7.259111e+07</td>
      <td>6.207652e+07</td>
      <td>1.287359e+06</td>
      <td>1.152442e+07</td>
      <td>1.407730e+08</td>
      <td>1.035752e+08</td>
      <td>4.983365e+07</td>
      <td>7.823538e+07</td>
      <td>3.741193e+06</td>
      <td>2.443456e+07</td>
      <td>5.221536e+07</td>
      <td>5.451975e+07</td>
      <td>...</td>
      <td>82.035061</td>
      <td>82.034793</td>
      <td>82.034532</td>
      <td>82.034278</td>
      <td>82.034032</td>
      <td>82.033792</td>
      <td>82.033560</td>
      <td>82.033335</td>
      <td>82.033117</td>
      <td>82.032906</td>
      <td>82.032702</td>
      <td>82.032505</td>
      <td>82.032316</td>
      <td>82.032134</td>
      <td>82.031958</td>
      <td>82.031790</td>
      <td>82.031630</td>
      <td>82.031476</td>
      <td>82.031329</td>
      <td>82.031190</td>
      <td>82.031058</td>
      <td>82.030932</td>
      <td>82.030815</td>
      <td>82.030704</td>
      <td>82.030600</td>
      <td>82.030504</td>
      <td>82.030414</td>
      <td>82.030332</td>
      <td>82.030257</td>
      <td>82.030189</td>
      <td>82.030128</td>
      <td>82.030075</td>
      <td>82.030028</td>
      <td>82.029989</td>
      <td>82.029957</td>
      <td>82.029932</td>
      <td>82.029914</td>
      <td>82.029903</td>
      <td>41.014950</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7527 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="c1"># Matrix of features (Independent variable), X: numpy.ndarray</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Dependent variable vector, y: numpy.ndarray</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h3>Preprocessing<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p><strong>1. Normalization</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="n">normalized_data</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>2. PCA - Dimensionality Reduction</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="c1"># What is the minimun value of `n_components` to keep 95% of variance on data ?</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">cumsum</span> <span class="o">&gt;=</span> <span class="mf">0.95</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The minimun value is:&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The minimun value is: 49
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Best altenative… set the <code class="docutils literal notranslate"><span class="pre">n_components</span></code> to fluctuate between 0.0 and 1.0, indicating the rate of variance you want to preserve</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id16">
<h3>Splitting the dataset into the Training set and Test set<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_reduced</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(98, 49) (98,) (33, 49) (33,)
</pre></div></div>
</div>
</div>
<div class="section" id="id17">
<h3>Train model<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># from sklearn.mixture import GaussianMixture</span>

<span class="c1"># classifier = GaussianMixture(n_components=2, random_state=42)</span>

<span class="c1"># classifier.fit(X_train, y_train)</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h4>Results<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># from sklearn.metrics import plot_confusion_matrix</span>

<span class="c1"># labels_formated = [&#39;confirmed exoplanets&#39;, &#39;eclipsing binaries&#39;]</span>

<span class="c1"># fig = plot_confusion_matrix(classifier, X_test, y_test,</span>
<span class="c1">#                              display_labels=labels_formated,</span>
<span class="c1">#                              cmap=plt.cm.Blues,</span>
<span class="c1">#                              normalize=&#39;true&#39;)</span>

<span class="c1"># fig.ax_.set_title(&#39;Gaussian Mixture Classifier - Confusion matrix&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="Lazy-Predict">
<h1>Lazy Predict<a class="headerlink" href="#Lazy-Predict" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p><a class="reference external" href="https://lazypredict.readthedocs.io/en/latest/usage.html#classification">https://lazypredict.readthedocs.io/en/latest/usage.html#classification</a></p>
<div class="section" id="id19">
<h2>Feature: Periodograms<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">FEATURES_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/features&#39;</span>
<span class="n">PERIODOGRAMS_DIR</span> <span class="o">=</span> <span class="n">FEATURES_DIR</span> <span class="o">+</span> <span class="s1">&#39;/feature_periodograms.csv&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">PERIODOGRAMS_DIR</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>7487</th>
      <th>7488</th>
      <th>7489</th>
      <th>7490</th>
      <th>7491</th>
      <th>7492</th>
      <th>7493</th>
      <th>7494</th>
      <th>7495</th>
      <th>7496</th>
      <th>7497</th>
      <th>7498</th>
      <th>7499</th>
      <th>7500</th>
      <th>7501</th>
      <th>7502</th>
      <th>7503</th>
      <th>7504</th>
      <th>7505</th>
      <th>7506</th>
      <th>7507</th>
      <th>7508</th>
      <th>7509</th>
      <th>7510</th>
      <th>7511</th>
      <th>7512</th>
      <th>7513</th>
      <th>7514</th>
      <th>7515</th>
      <th>7516</th>
      <th>7517</th>
      <th>7518</th>
      <th>7519</th>
      <th>7520</th>
      <th>7521</th>
      <th>7522</th>
      <th>7523</th>
      <th>7524</th>
      <th>7525</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>5.244937e-22</td>
      <td>1.656106e+11</td>
      <td>4.241954e+10</td>
      <td>1.295592e+10</td>
      <td>1.441850e+10</td>
      <td>7.333357e+09</td>
      <td>3.654204e+09</td>
      <td>8.038780e+08</td>
      <td>2.345564e+09</td>
      <td>3.428295e+08</td>
      <td>1.486851e+08</td>
      <td>4.355384e+07</td>
      <td>1.922543e+09</td>
      <td>1.190937e+09</td>
      <td>1.042278e+09</td>
      <td>2.177381e+09</td>
      <td>2.186346e+08</td>
      <td>2.266618e+08</td>
      <td>1.933830e+08</td>
      <td>1.024137e+09</td>
      <td>6.308557e+07</td>
      <td>3.175023e+08</td>
      <td>3.831862e+08</td>
      <td>1.347591e+08</td>
      <td>4.991692e+07</td>
      <td>6.616579e+07</td>
      <td>3.089654e+08</td>
      <td>2.338376e+08</td>
      <td>1.757878e+08</td>
      <td>1.022475e+08</td>
      <td>1.619658e+08</td>
      <td>2.161862e+07</td>
      <td>7.733964e+07</td>
      <td>1.881846e+08</td>
      <td>2.409856e+07</td>
      <td>1.216204e+08</td>
      <td>5.106637e+07</td>
      <td>2.844362e+07</td>
      <td>1.700110e+08</td>
      <td>1.287244e+07</td>
      <td>...</td>
      <td>2.901623e+06</td>
      <td>9.709432e+06</td>
      <td>6.766949e+06</td>
      <td>3.311118e+07</td>
      <td>3.102628e+06</td>
      <td>6.014224e+06</td>
      <td>1.052508e+07</td>
      <td>1.792224e+06</td>
      <td>5.597886e+06</td>
      <td>8.938615e+06</td>
      <td>2.654949e+06</td>
      <td>3.223749e+05</td>
      <td>1.365606e+07</td>
      <td>5.680955e+06</td>
      <td>1.315171e+07</td>
      <td>1.306965e+07</td>
      <td>1.334836e+06</td>
      <td>2.123376e+07</td>
      <td>3.334838e+04</td>
      <td>4.742393e+06</td>
      <td>6.822047e+05</td>
      <td>4.105110e+07</td>
      <td>9.704217e+06</td>
      <td>1.313942e+06</td>
      <td>7.024191e+06</td>
      <td>3.920979e+05</td>
      <td>1.611153e+07</td>
      <td>8.167207e+06</td>
      <td>1.913767e+07</td>
      <td>3.936906e+06</td>
      <td>4.087972e+06</td>
      <td>2.124753e+07</td>
      <td>1.382830e+07</td>
      <td>3.013891e+06</td>
      <td>1.112224e+07</td>
      <td>1.568576e+07</td>
      <td>6.561321e+06</td>
      <td>2.489063e+06</td>
      <td>2.142671e+05</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109</th>
      <td>5.222241e-23</td>
      <td>7.189921e+10</td>
      <td>9.901414e+10</td>
      <td>1.476100e+10</td>
      <td>1.398462e+10</td>
      <td>1.147834e+10</td>
      <td>6.674100e+09</td>
      <td>4.094150e+09</td>
      <td>3.790864e+10</td>
      <td>4.962443e+09</td>
      <td>9.110133e+08</td>
      <td>1.529316e+09</td>
      <td>2.659406e+08</td>
      <td>5.565563e+09</td>
      <td>2.297864e+06</td>
      <td>2.821536e+09</td>
      <td>2.618699e+09</td>
      <td>2.476775e+09</td>
      <td>2.353264e+08</td>
      <td>3.537825e+09</td>
      <td>4.176115e+07</td>
      <td>1.394874e+08</td>
      <td>2.349405e+09</td>
      <td>4.841487e+07</td>
      <td>4.160097e+09</td>
      <td>3.921834e+08</td>
      <td>1.123126e+09</td>
      <td>2.430828e+08</td>
      <td>1.808513e+09</td>
      <td>4.106579e+08</td>
      <td>5.394205e+07</td>
      <td>1.265701e+09</td>
      <td>2.936783e+08</td>
      <td>4.351451e+06</td>
      <td>5.507590e+08</td>
      <td>2.131361e+08</td>
      <td>1.194628e+09</td>
      <td>4.435846e+08</td>
      <td>6.775218e+07</td>
      <td>6.498562e+07</td>
      <td>...</td>
      <td>1.676719e+07</td>
      <td>1.069171e+06</td>
      <td>1.431339e+07</td>
      <td>7.417587e+06</td>
      <td>2.241231e+07</td>
      <td>4.796347e+06</td>
      <td>7.506176e+05</td>
      <td>2.630452e+06</td>
      <td>9.664950e+05</td>
      <td>2.038954e+07</td>
      <td>1.462608e+07</td>
      <td>2.389343e+07</td>
      <td>1.720616e+06</td>
      <td>4.120930e+05</td>
      <td>3.470017e+06</td>
      <td>3.228340e+06</td>
      <td>5.715047e+05</td>
      <td>1.583645e+07</td>
      <td>2.447099e+07</td>
      <td>2.556097e+07</td>
      <td>4.713815e+06</td>
      <td>1.216467e+07</td>
      <td>1.930779e+07</td>
      <td>1.756057e+07</td>
      <td>2.729222e+07</td>
      <td>1.440361e+07</td>
      <td>1.199978e+07</td>
      <td>5.090961e+06</td>
      <td>4.848588e+06</td>
      <td>1.571179e+07</td>
      <td>3.844894e+06</td>
      <td>2.743101e+06</td>
      <td>4.370159e+05</td>
      <td>5.439133e+06</td>
      <td>7.427570e+04</td>
      <td>1.760637e+06</td>
      <td>2.320080e+06</td>
      <td>6.450329e+06</td>
      <td>5.866100e+06</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.741909e-23</td>
      <td>7.970192e+09</td>
      <td>3.650109e+09</td>
      <td>1.582624e+09</td>
      <td>3.266343e+10</td>
      <td>3.377317e+10</td>
      <td>1.471925e+09</td>
      <td>1.665996e+08</td>
      <td>8.887137e+09</td>
      <td>4.330463e+10</td>
      <td>2.479880e+09</td>
      <td>2.478121e+08</td>
      <td>7.060146e+08</td>
      <td>1.036437e+10</td>
      <td>3.542269e+08</td>
      <td>4.027595e+06</td>
      <td>3.590214e+08</td>
      <td>1.353871e+09</td>
      <td>4.792989e+08</td>
      <td>5.705030e+08</td>
      <td>8.400022e+08</td>
      <td>7.151057e+08</td>
      <td>2.327222e+08</td>
      <td>2.219457e+08</td>
      <td>1.349461e+08</td>
      <td>2.387996e+09</td>
      <td>5.975332e+09</td>
      <td>3.989845e+08</td>
      <td>1.002950e+08</td>
      <td>3.872512e+07</td>
      <td>9.498571e+07</td>
      <td>2.608256e+08</td>
      <td>1.725462e+08</td>
      <td>5.317832e+08</td>
      <td>1.437279e+08</td>
      <td>1.145169e+08</td>
      <td>8.002391e+07</td>
      <td>2.828761e+08</td>
      <td>6.701132e+09</td>
      <td>1.186455e+09</td>
      <td>...</td>
      <td>1.947367e+03</td>
      <td>1.947360e+03</td>
      <td>1.947354e+03</td>
      <td>1.947348e+03</td>
      <td>1.947342e+03</td>
      <td>1.947337e+03</td>
      <td>1.947331e+03</td>
      <td>1.947326e+03</td>
      <td>1.947320e+03</td>
      <td>1.947315e+03</td>
      <td>1.947311e+03</td>
      <td>1.947306e+03</td>
      <td>1.947301e+03</td>
      <td>1.947297e+03</td>
      <td>1.947293e+03</td>
      <td>1.947289e+03</td>
      <td>1.947285e+03</td>
      <td>1.947282e+03</td>
      <td>1.947278e+03</td>
      <td>1.947275e+03</td>
      <td>1.947272e+03</td>
      <td>1.947269e+03</td>
      <td>1.947266e+03</td>
      <td>1.947263e+03</td>
      <td>1.947261e+03</td>
      <td>1.947258e+03</td>
      <td>1.947256e+03</td>
      <td>1.947254e+03</td>
      <td>1.947253e+03</td>
      <td>1.947251e+03</td>
      <td>1.947250e+03</td>
      <td>1.947248e+03</td>
      <td>1.947247e+03</td>
      <td>1.947246e+03</td>
      <td>1.947245e+03</td>
      <td>1.947245e+03</td>
      <td>1.947244e+03</td>
      <td>1.947244e+03</td>
      <td>9.736221e+02</td>
      <td>0</td>
    </tr>
    <tr>
      <th>107</th>
      <td>1.537079e-21</td>
      <td>2.334249e+10</td>
      <td>1.246708e+11</td>
      <td>7.693346e+10</td>
      <td>3.661008e+10</td>
      <td>9.257208e+08</td>
      <td>1.661148e+09</td>
      <td>4.462807e+09</td>
      <td>2.758899e+09</td>
      <td>2.238848e+09</td>
      <td>8.078527e+09</td>
      <td>3.787129e+09</td>
      <td>5.939399e+09</td>
      <td>3.755190e+09</td>
      <td>3.769742e+09</td>
      <td>4.052975e+08</td>
      <td>5.671221e+09</td>
      <td>6.723360e+09</td>
      <td>1.641852e+09</td>
      <td>5.226829e+09</td>
      <td>6.062483e+08</td>
      <td>1.519938e+09</td>
      <td>1.789390e+09</td>
      <td>2.119600e+07</td>
      <td>1.049363e+09</td>
      <td>1.143246e+08</td>
      <td>3.384769e+08</td>
      <td>5.382716e+08</td>
      <td>7.376932e+08</td>
      <td>8.038340e+08</td>
      <td>8.351175e+08</td>
      <td>2.170651e+08</td>
      <td>6.091711e+06</td>
      <td>1.795124e+09</td>
      <td>8.766678e+07</td>
      <td>6.037906e+07</td>
      <td>9.266256e+08</td>
      <td>3.747338e+08</td>
      <td>1.156053e+09</td>
      <td>5.333725e+07</td>
      <td>...</td>
      <td>7.612817e+00</td>
      <td>7.612792e+00</td>
      <td>7.612768e+00</td>
      <td>7.612744e+00</td>
      <td>7.612721e+00</td>
      <td>7.612699e+00</td>
      <td>7.612677e+00</td>
      <td>7.612656e+00</td>
      <td>7.612636e+00</td>
      <td>7.612617e+00</td>
      <td>7.612598e+00</td>
      <td>7.612580e+00</td>
      <td>7.612562e+00</td>
      <td>7.612545e+00</td>
      <td>7.612529e+00</td>
      <td>7.612513e+00</td>
      <td>7.612498e+00</td>
      <td>7.612484e+00</td>
      <td>7.612470e+00</td>
      <td>7.612457e+00</td>
      <td>7.612445e+00</td>
      <td>7.612434e+00</td>
      <td>7.612423e+00</td>
      <td>7.612412e+00</td>
      <td>7.612403e+00</td>
      <td>7.612394e+00</td>
      <td>7.612385e+00</td>
      <td>7.612378e+00</td>
      <td>7.612371e+00</td>
      <td>7.612365e+00</td>
      <td>7.612359e+00</td>
      <td>7.612354e+00</td>
      <td>7.612350e+00</td>
      <td>7.612346e+00</td>
      <td>7.612343e+00</td>
      <td>7.612341e+00</td>
      <td>7.612339e+00</td>
      <td>7.612338e+00</td>
      <td>3.806169e+00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>90</th>
      <td>1.676619e-22</td>
      <td>6.268024e+10</td>
      <td>1.892612e+09</td>
      <td>4.589268e+09</td>
      <td>2.553798e+09</td>
      <td>1.436860e+09</td>
      <td>1.871399e+09</td>
      <td>6.763201e+08</td>
      <td>8.569126e+08</td>
      <td>4.346068e+08</td>
      <td>3.224972e+09</td>
      <td>6.266573e+08</td>
      <td>5.095192e+08</td>
      <td>2.118835e+07</td>
      <td>2.047743e+09</td>
      <td>1.136897e+10</td>
      <td>9.023897e+10</td>
      <td>1.642913e+10</td>
      <td>1.140840e+10</td>
      <td>8.220013e+09</td>
      <td>7.671658e+09</td>
      <td>3.662531e+09</td>
      <td>7.649781e+09</td>
      <td>7.552201e+09</td>
      <td>9.279831e+09</td>
      <td>6.586815e+09</td>
      <td>8.289219e+09</td>
      <td>1.490018e+10</td>
      <td>2.078385e+10</td>
      <td>3.645875e+10</td>
      <td>4.881829e+10</td>
      <td>1.412379e+11</td>
      <td>1.441203e+12</td>
      <td>9.568005e+11</td>
      <td>1.428168e+11</td>
      <td>5.584073e+10</td>
      <td>2.796076e+10</td>
      <td>1.304114e+10</td>
      <td>1.200738e+10</td>
      <td>8.144469e+09</td>
      <td>...</td>
      <td>1.037832e+03</td>
      <td>1.037829e+03</td>
      <td>1.037825e+03</td>
      <td>1.037822e+03</td>
      <td>1.037819e+03</td>
      <td>1.037816e+03</td>
      <td>1.037813e+03</td>
      <td>1.037810e+03</td>
      <td>1.037807e+03</td>
      <td>1.037805e+03</td>
      <td>1.037802e+03</td>
      <td>1.037800e+03</td>
      <td>1.037797e+03</td>
      <td>1.037795e+03</td>
      <td>1.037793e+03</td>
      <td>1.037791e+03</td>
      <td>1.037789e+03</td>
      <td>1.037787e+03</td>
      <td>1.037785e+03</td>
      <td>1.037783e+03</td>
      <td>1.037781e+03</td>
      <td>1.037780e+03</td>
      <td>1.037778e+03</td>
      <td>1.037777e+03</td>
      <td>1.037776e+03</td>
      <td>1.037774e+03</td>
      <td>1.037773e+03</td>
      <td>1.037772e+03</td>
      <td>1.037771e+03</td>
      <td>1.037770e+03</td>
      <td>1.037770e+03</td>
      <td>1.037769e+03</td>
      <td>1.037768e+03</td>
      <td>1.037768e+03</td>
      <td>1.037767e+03</td>
      <td>1.037767e+03</td>
      <td>1.037767e+03</td>
      <td>1.037767e+03</td>
      <td>5.188833e+02</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 7527 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="c1"># Matrix of features (Independent variable), X: numpy.ndarray</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Dependent variable vector, y: numpy.ndarray</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h3>Preprocessing<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p><strong>1. Normalization</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="n">normalized_data</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>2. PCA - Dimensionality Reduction</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="c1"># What is the minimun value of `n_components` to keep 95% of variance on data ?</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">cumsum</span> <span class="o">&gt;=</span> <span class="mf">0.95</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The minimun value is:&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The minimun value is: 49
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Best altenative… set the <code class="docutils literal notranslate"><span class="pre">n_components</span></code> to fluctuate between 0.0 and 1.0, indicating the rate of variance you want to preserve</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">normalized_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id21">
<h3>Splitting the dataset into the Training set and Test set<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_reduced</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(98, 49) (98,) (33, 49) (33,)
</pre></div></div>
</div>
</div>
<div class="section" id="id22">
<h3>Train model<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>pip install lazypredict
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">lazypredict.Supervised</span> <span class="kn">import</span> <span class="n">LazyClassifier</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">LazyClassifier</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">models</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 29/29 [00:01&lt;00:00, 24.28it/s]
</pre></div></div>
</div>
<div class="section" id="id23">
<h4>Results<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Accuracy</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model
QuadraticDiscriminantAnalysis   0.70
SVC                             0.70
AdaBoostClassifier              0.70
XGBClassifier                   0.70
ExtraTreesClassifier            0.70
RandomForestClassifier          0.70
CalibratedClassifierCV          0.70
KNeighborsClassifier            0.67
LGBMClassifier                  0.67
BaggingClassifier               0.67
NearestCentroid                 0.67
DecisionTreeClassifier          0.64
BernoulliNB                     0.64
GaussianNB                      0.64
DummyClassifier                 0.61
SGDClassifier                   0.58
LinearDiscriminantAnalysis      0.58
RidgeClassifier                 0.55
ExtraTreeClassifier             0.55
LogisticRegression              0.55
Perceptron                      0.52
PassiveAggressiveClassifier     0.52
LinearSVC                       0.52
RidgeClassifierCV               0.52
LabelSpreading                  0.33
LabelPropagation                0.33
Name: Accuracy, dtype: float64
</pre></div></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modules.html" class="btn btn-neutral float-right" title="Filtering Techniques" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="05%20-%20Feature%20Engineering.html" class="btn btn-neutral float-left" title="Reading the data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Guilherme Samuel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>